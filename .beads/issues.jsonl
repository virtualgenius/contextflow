{"id":"contextflow-072","title":"Make connecting contexts obvious and easy","description":"Connection handle dots are too small and hard to select. It's not obvious to the user how to connect contexts together, or easy to do. Needs to be immediately discoverable and forgiving to interact with. Eric Evans feedback; prior fix-connections work did not fully resolve this.\n\nAcceptance criteria:\n- Connection handles are large enough to be obvious affordances\n- Hit targets are generous (easy to grab even with imprecise clicks)\n- The interaction for connecting two contexts is visually clear (user shouldn't have to guess)\n- Feedback during drag makes it obvious what will happen (e.g. target context highlights)","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-13T11:23:31.698106-07:00","created_by":"Paul Rayner","updated_at":"2026-02-13T15:16:11.549269-07:00","closed_at":"2026-02-13T15:16:11.549269-07:00","close_reason":"Closed"}
{"id":"contextflow-0ij","title":"Remove ColorLegend component and related store state","description":"The context hover tooltip (contextflow-vlf + contextflow-3d1) replaces the ColorLegend. Delete src/components/ColorLegend.tsx, remove showColorLegend and setShowColorLegend from store.ts and storeTypes.ts, remove any toggle in TopBar or settings that references it. Clean up imports in CanvasArea.tsx.","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-14T09:51:54.648308-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T10:11:10.222566-07:00","closed_at":"2026-02-14T10:11:10.222566-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-0ij","depends_on_id":"contextflow-3d1","type":"blocks","created_at":"2026-02-14T09:51:58.499244-07:00","created_by":"Paul Rayner"}]}
{"id":"contextflow-0l0","title":"Always show relationship labels on edges","description":"Add a 'Show Relationship Labels' toggle in View Options (SettingsViewOptions.tsx) that controls whether pattern names are always visible on relationship edges. Default to ON.\n\n## Current behavior\nLabels only appear on hover/selection, gated at RelationshipEdge.tsx:355:\n```tsx\n{(isEmphasized || isHighlightedByHover) \u0026\u0026 (() =\u003e {\n```\n\n## Implementation\n\n### 1. Add state to store\n- **storeTypes.ts:74** - add `showRelationshipLabels: boolean` in View filters block (after `showTeamLabels`)\n- **storeTypes.ts:165** - add `toggleRelationshipLabels: () =\u003e void` in actions block (after `toggleTeamLabels`)\n- **store.ts ~145** - initialize with localStorage, default true:\n  ```ts\n  showRelationshipLabels: (() =\u003e {\n    const stored = localStorage.getItem('contextflow.showRelationshipLabels')\n    return stored !== null ? stored === 'true' : true\n  })(),\n  ```\n- **store.ts ~718** - add toggle action (follow toggleTeamLabels pattern):\n  ```ts\n  toggleRelationshipLabels: () =\u003e set((state) =\u003e {\n    const newValue = !state.showRelationshipLabels\n    localStorage.setItem('contextflow.showRelationshipLabels', String(newValue))\n    return { showRelationshipLabels: newValue }\n  }),\n  ```\n- **mockState.ts** - add `showRelationshipLabels: true` (~line 116) and `toggleRelationshipLabels: vi.fn()` (~line 181)\n\n### 2. Update RelationshipEdge.tsx\n- Read `showRelationshipLabels` from store via `useEditorStore`\n- Change line 355 condition from:\n  ```tsx\n  {(isEmphasized || isHighlightedByHover) \u0026\u0026 (() =\u003e {\n  ```\n  to:\n  ```tsx\n  {(showRelationshipLabels || isEmphasized || isHighlightedByHover) \u0026\u0026 (() =\u003e {\n  ```\n\n### 3. Add toggle to SettingsViewOptions.tsx\n- Add switch after the 'Show Relationships' toggle (line 58), nested/indented to indicate it's a sub-option:\n  ```tsx\n  \u003cdiv className=\"flex items-center justify-between\"\u003e\n    \u003cspan className=\"text-xs text-slate-600 dark:text-slate-400\"\u003eShow Relationship Labels\u003c/span\u003e\n    \u003cSwitch checked={showRelationshipLabels} onCheckedChange={() =\u003e toggleRelationshipLabels()} /\u003e\n  \u003c/div\u003e\n  ```\n- Place it between the 'Show Relationships' toggle and the 'Available in Flow \u0026 Strategic views' helper text\n\n### 4. Tests\n- Test the toggle in SettingsViewOptions tests (if they exist) or add a rendering test\n- Test that RelationshipEdge renders labels when showRelationshipLabels is true, even when not hovered/selected\n\n## Acceptance criteria\n- Labels visible on all relationship edges by default (no hover required)\n- Toggle in View Options controls visibility\n- Setting persists across page reloads via localStorage\n- Hover/selection still emphasizes labels (stronger styling) even when always-visible\n- ACL/OHS indicator boxes are unaffected (they have their own rendering path)","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-16T15:12:06.739363-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T15:21:05.861313-07:00","closed_at":"2026-02-16T15:21:05.861313-07:00","close_reason":"Closed"}
{"id":"contextflow-0sv","title":"collab-004: Replace undo/redo with Y.UndoManager","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:00.467753+08:00","updated_at":"2025-12-02T18:13:20.814539+08:00","closed_at":"2025-12-02T18:13:20.814539+08:00","dependencies":[{"issue_id":"contextflow-0sv","depends_on_id":"contextflow-5k3","type":"blocks","created_at":"2025-12-01T18:00:34.565485+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-0tm","title":"Inspector refactor: remaining panels","description":"Extract remaining InspectorPanel selection blocks into dedicated components under src/components/inspector, preserving behavior and styling. This epic covers the remaining selection types still rendered inline in InspectorPanel.","design":"Goal: one inspector component per selection type. Keep UX identical and do not change business logic. Prefer inspectorShared.tsx for shared styles and Section headers. Use SimpleTooltip vs InfoTooltip per existing behavior; do not introduce native title attributes. Avoid merge conflicts by isolating component extraction from routing updates until final integration. App.tsx visibility rules should not change (no new selection types).\\n\\nTesting: add focused component unit tests for each new inspector component using Vitest + Testing Library. Avoid full-stack/integration coverage. Each inspector task should add a test file under src/components/inspector/__tests__/ and use store mocks (see existing component tests for mocking useEditorStore).","acceptance_criteria":"Each remaining inline inspector block is moved to a dedicated component under src/components/inspector. InspectorPanel is reduced to routing logic for selections. Visuals and behavior match the current UI. Focused component tests exist for each inspector and pass.","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-02-03T11:19:02.674996-07:00","updated_at":"2026-02-13T11:17:15.083299-07:00","closed_at":"2026-02-13T11:17:15.083299-07:00","close_reason":"Closed"}
{"id":"contextflow-0tm.1","title":"Extract UserNeedInspector","description":"Extract the selectedUserNeedId inspector UI from InspectorPanel into src/components/inspector/UserNeedInspector.tsx.","design":"Implement UserNeedInspector({ project, userNeedId }). Preserve: name/description editing, connected users list, connected contexts list, delete action, and selection transitions via useEditorStore.setState. Keep identical text, placeholders, and tooltips. Use inspectorShared (INPUT_TITLE_CLASS, TEXTAREA_CLASS, Section).\\n\\nTesting: add src/components/inspector/__tests__/UserNeedInspector.test.tsx. Cover rendering, name/description edits (calls updateUserNeed), navigation buttons (setState), and delete confirmation (deleteUserNeed when confirmed). Use vi.mock for useEditorStore + window.confirm. Suggested command: npm test -- src/components/inspector/__tests__/UserNeedInspector.test.tsx","acceptance_criteria":"UserNeedInspector renders exactly the same UI/behavior as before. InspectorPanel only routes to it for selectedUserNeedId. Focused unit test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T11:19:12.864883-07:00","updated_at":"2026-02-13T11:17:15.066595-07:00","closed_at":"2026-02-13T11:17:15.066595-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-0tm.1","depends_on_id":"contextflow-0tm","type":"parent-child","created_at":"2026-02-03T11:19:12.865786-07:00","created_by":"paul","metadata":"{}"}]}
{"id":"contextflow-0tm.2","title":"Extract RelationshipInspector","description":"Extract the selectedRelationshipId inspector UI from InspectorPanel into src/components/inspector/RelationshipInspector.tsx.","design":"Implement RelationshipInspector({ project, relationshipId }). Preserve: pattern selection UI, swap direction button behavior, description input, and delete action. Keep usage of PATTERN_DEFINITIONS/getPatternDefinition, InfoTooltip, SimpleTooltip, and pattern icons. Use inspectorShared for shared input styles and keep all text/labels the same.\\n\\nTesting: add src/components/inspector/__tests__/RelationshipInspector.test.tsx. Cover rendering, pattern change (updateRelationship), swap direction (swapRelationshipDirection), description edit, and delete confirmation. Mock useEditorStore and window.confirm. Suggested command: npm test -- src/components/inspector/__tests__/RelationshipInspector.test.tsx","acceptance_criteria":"RelationshipInspector renders the same UI and behavior as the inline block. InspectorPanel only routes to it for selectedRelationshipId. Focused unit test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T11:19:23.509988-07:00","updated_at":"2026-02-13T11:17:15.069325-07:00","closed_at":"2026-02-13T11:17:15.069325-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-0tm.2","depends_on_id":"contextflow-0tm","type":"parent-child","created_at":"2026-02-03T11:19:23.510944-07:00","created_by":"paul","metadata":"{}"}]}
{"id":"contextflow-0tm.3","title":"Extract UserNeedConnectionInspector","description":"Extract the selectedUserNeedConnectionId inspector UI from InspectorPanel into src/components/inspector/UserNeedConnectionInspector.tsx.","design":"Implement UserNeedConnectionInspector({ project, connectionId }). Preserve: connection header (User -\u003e Need), navigation buttons to user/need, notes textarea behavior (empty -\u003e undefined), and delete action. Keep SimpleTooltip/InfoTooltip usage and text labels. Use inspectorShared styles.\\n\\nTesting: add src/components/inspector/__tests__/UserNeedConnectionInspector.test.tsx. Cover rendering of user/need names, navigation buttons (setState), notes edit/update (updateUserNeedConnection), and delete confirmation. Mock useEditorStore and window.confirm. Suggested command: npm test -- src/components/inspector/__tests__/UserNeedConnectionInspector.test.tsx","acceptance_criteria":"UserNeedConnectionInspector matches current UI and behavior. InspectorPanel only routes to it for selectedUserNeedConnectionId. Focused unit test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T11:19:33.078754-07:00","updated_at":"2026-02-13T11:17:15.071157-07:00","closed_at":"2026-02-13T11:17:15.071157-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-0tm.3","depends_on_id":"contextflow-0tm","type":"parent-child","created_at":"2026-02-03T11:19:33.079708-07:00","created_by":"paul","metadata":"{}"}]}
{"id":"contextflow-0tm.4","title":"Extract NeedContextConnectionInspector","description":"Extract the selectedNeedContextConnectionId inspector UI from InspectorPanel into src/components/inspector/NeedContextConnectionInspector.tsx.","design":"Implement NeedContextConnectionInspector({ project, connectionId }). Preserve: connection header (Need -\u003e Context), navigation buttons to need/context, notes textarea behavior (empty -\u003e undefined), and delete action. Keep SimpleTooltip/InfoTooltip usage and text labels. Use inspectorShared styles.\\n\\nTesting: add src/components/inspector/__tests__/NeedContextConnectionInspector.test.tsx. Cover rendering of need/context names, navigation buttons (setState), notes edit/update (updateNeedContextConnection), and delete confirmation. Mock useEditorStore and window.confirm. Suggested command: npm test -- src/components/inspector/__tests__/NeedContextConnectionInspector.test.tsx","acceptance_criteria":"NeedContextConnectionInspector matches current UI and behavior. InspectorPanel only routes to it for selectedNeedContextConnectionId. Focused unit test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T11:19:43.484851-07:00","updated_at":"2026-02-13T11:17:15.073196-07:00","closed_at":"2026-02-13T11:17:15.073196-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-0tm.4","depends_on_id":"contextflow-0tm","type":"parent-child","created_at":"2026-02-03T11:19:43.485625-07:00","created_by":"paul","metadata":"{}"}]}
{"id":"contextflow-0tm.5","title":"Extract FlowStageInspector","description":"Extract the selectedStageIndex inspector UI from InspectorPanel into src/components/inspector/FlowStageInspector.tsx.","design":"Implement FlowStageInspector({ project, stageIndex }). Preserve: stage label editing, user and user-need lists with navigation, add/remove behavior, and delete stage action. Keep setSelectedStage usage and selection transitions intact. Use inspectorShared styles and existing text labels.\\n\\nTesting: add src/components/inspector/__tests__/FlowStageInspector.test.tsx. Cover rendering, stage label edit (updateFlowStage), user/need navigation (setState), remove actions, and delete confirmation (deleteFlowStage). Mock useEditorStore and window.confirm. Suggested command: npm test -- src/components/inspector/__tests__/FlowStageInspector.test.tsx","acceptance_criteria":"FlowStageInspector matches current UI and behavior. InspectorPanel only routes to it for selectedStageIndex. Focused unit test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T11:19:53.932943-07:00","updated_at":"2026-02-13T11:17:15.075032-07:00","closed_at":"2026-02-13T11:17:15.075032-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-0tm.5","depends_on_id":"contextflow-0tm","type":"parent-child","created_at":"2026-02-03T11:19:53.933663-07:00","created_by":"paul","metadata":"{}"}]}
{"id":"contextflow-0tm.6","title":"Extract TeamInspector","description":"Extract the selectedTeamId inspector UI from InspectorPanel into src/components/inspector/TeamInspector.tsx.","design":"Implement TeamInspector({ project, teamId }). Preserve: team fields (name, topologyType, jiraBoard, slackChannel), assigned contexts list, add team button, and delete team confirmation. Keep tooltip behavior and any existing text labels. Use inspectorShared styles.\\n\\nTesting: add src/components/inspector/__tests__/TeamInspector.test.tsx. Cover rendering, field edits (updateTeam), add team (addTeam), and delete confirmation (deleteTeam). Mock useEditorStore and window.confirm. Suggested command: npm test -- src/components/inspector/__tests__/TeamInspector.test.tsx","acceptance_criteria":"TeamInspector matches current UI and behavior. InspectorPanel only routes to it for selectedTeamId. Focused unit test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T11:20:04.130428-07:00","updated_at":"2026-02-13T11:17:15.076975-07:00","closed_at":"2026-02-13T11:17:15.076975-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-0tm.6","depends_on_id":"contextflow-0tm","type":"parent-child","created_at":"2026-02-03T11:20:04.131273-07:00","created_by":"paul","metadata":"{}"}]}
{"id":"contextflow-0tm.7","title":"Extract ContextInspector","description":"Extract the selectedContextId inspector UI from InspectorPanel into src/components/inspector/ContextInspector.tsx and move RepoCard/CodeCohesion helpers out of InspectorPanel.","design":"Implement ContextInspector({ project, contextId }) to render the full context inspector block as-is, including teams, ownership, groups, temporal position, repos, code size, boundary integrity, notes, issues, relationships, and delete action. Extract RepoCard + CodeCohesion hooks into a helper module (e.g. src/components/inspector/ContextRepoCard.tsx) to keep ContextInspector readable. Preserve all tooltips, labels, and selection transitions. Use inspectorShared styles where currently used. Do not change behavior or remove features.\\n\\nTesting: add src/components/inspector/__tests__/ContextInspector.test.tsx. Keep this focused: smoke render, basic field edit (updateContext), delete confirmation (deleteContext), and one representative interaction like toggling legacy or updating ownership. Avoid testing RepoCard API fetches; mock hooks/helpers as needed. Suggested command: npm test -- src/components/inspector/__tests__/ContextInspector.test.tsx","acceptance_criteria":"ContextInspector renders exactly the same UI/behavior as before. RepoCard and CodeCohesion hooks are no longer defined in InspectorPanel. InspectorPanel only routes to ContextInspector for selectedContextId. Focused unit test passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T11:20:15.155812-07:00","updated_at":"2026-02-13T11:17:15.078865-07:00","closed_at":"2026-02-13T11:17:15.078865-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-0tm.7","depends_on_id":"contextflow-0tm","type":"parent-child","created_at":"2026-02-03T11:20:15.156738-07:00","created_by":"paul","metadata":"{}"}]}
{"id":"contextflow-0tm.8","title":"Integrate extracted inspectors into InspectorPanel","description":"After all inspector components are extracted, replace inline inspector blocks in InspectorPanel with component routing and remove unused imports/helpers.","design":"Integrate the new inspectors into InspectorPanel in a single pass to avoid conflicts. Remove inline JSX and any leftover helper components/hooks (RepoCard, CodeCohesion hooks) that were previously in InspectorPanel. Keep App.tsx visibility logic unchanged since no new selection types are added.\\n\\nTesting: no new tests required here beyond running the focused tests from each inspector task. After all inspector tests pass, run the full suite via npm test.","acceptance_criteria":"InspectorPanel contains only selection routing and shared state; no inline inspector JSX remains for extracted panels. App.tsx visibility logic stays the same. All focused inspector tests pass; full test run passes after integration.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T11:20:26.455961-07:00","updated_at":"2026-02-13T11:17:15.081288-07:00","closed_at":"2026-02-13T11:17:15.081288-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-0tm.8","depends_on_id":"contextflow-0tm","type":"parent-child","created_at":"2026-02-03T11:20:26.456839-07:00","created_by":"paul","metadata":"{}"},{"issue_id":"contextflow-0tm.8","depends_on_id":"contextflow-0tm.1","type":"blocks","created_at":"2026-02-03T11:20:35.914003-07:00","created_by":"paul","metadata":"{}"},{"issue_id":"contextflow-0tm.8","depends_on_id":"contextflow-0tm.2","type":"blocks","created_at":"2026-02-03T11:20:43.529196-07:00","created_by":"paul","metadata":"{}"},{"issue_id":"contextflow-0tm.8","depends_on_id":"contextflow-0tm.3","type":"blocks","created_at":"2026-02-03T11:20:51.659492-07:00","created_by":"paul","metadata":"{}"},{"issue_id":"contextflow-0tm.8","depends_on_id":"contextflow-0tm.4","type":"blocks","created_at":"2026-02-03T11:21:01.124832-07:00","created_by":"paul","metadata":"{}"},{"issue_id":"contextflow-0tm.8","depends_on_id":"contextflow-0tm.5","type":"blocks","created_at":"2026-02-03T11:21:10.509407-07:00","created_by":"paul","metadata":"{}"},{"issue_id":"contextflow-0tm.8","depends_on_id":"contextflow-0tm.6","type":"blocks","created_at":"2026-02-03T11:21:19.680665-07:00","created_by":"paul","metadata":"{}"},{"issue_id":"contextflow-0tm.8","depends_on_id":"contextflow-0tm.7","type":"blocks","created_at":"2026-02-03T11:21:29.653698-07:00","created_by":"paul","metadata":"{}"}]}
{"id":"contextflow-1b9","title":"Add architectural test to prevent direct Zustand writes for synced data","description":"## Problem\n\nWe've fixed two rounds of store mutations bypassing Yjs (issue CRUD in contextflow-co0, 3 more in contextflow-8yw). This class of bug is silent: data appears to save but gets overwritten on the next sync event. We need an automated guard.\n\n## Goal\n\nA single architectural test that fails if any store mutation writes synced project data directly to Zustand instead of routing through Yjs.\n\n## Approach: Convention Enforcement via Source Scanning\n\n**Key insight**: A store `set()` callback is safe if and only if the partial state it returns does NOT contain `projects:`. Only project-lifecycle operations (create, delete, duplicate, import, reset) need direct project writes because they bootstrap/teardown collab sessions.\n\n### Implementation\n\nCreate `src/model/sync/__tests__/noYjsBypass.test.ts`:\n\n1. Read `store.ts` as a string (no AST dependency needed)\n2. Find all mutation definitions matching `name: (...) =\u003e set(`\n3. Extract each mutation's `set()` body using balanced-paren matching\n4. Check whether the body contains `projects:` in the return value\n5. Flag any mutation not in the allowlist\n\n### Allowlist (project-lifecycle operations that legitimately write `projects:`)\n\n```typescript\nconst ALLOWED_PROJECT_WRITERS = new Set([\n  'deleteProject',\n  'duplicateProject',\n  'importProject',\n  'reset',\n]);\n```\n\nThese all create/destroy collab sessions, so direct writes are correct.\n\n### What the test catches\n\n- Any new mutation that returns `{ projects: ... }` from a `set()` call\n- Clear error message: \"store action 'foo' writes to projects without routing through Yjs\"\n- Catches structural violations at the pattern level (one test for all mutations)\n\n### Why not AST or runtime snapshots?\n\n- **AST**: Requires cross-file dataflow analysis (actions in separate files), new dependencies, brittle\n- **Runtime snapshots**: Requires N separate test cases (one per mutation), tests effect not cause\n- **Source scanning**: Zero dependencies, one test covers all current and future mutations\n\n## Acceptance Criteria\n- [ ] Test in `src/model/sync/__tests__/noYjsBypass.test.ts`\n- [ ] Fails if a new store mutation returns `{ projects: ... }` outside the allowlist\n- [ ] Passes for all current (fixed) mutations\n- [ ] Clear error message pointing to the offending mutation name\n- [ ] Code comment at top of test explains the Yjs sync constraint and why this guard exists","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-13T13:34:15.963131-07:00","created_by":"Paul Rayner","updated_at":"2026-02-13T15:21:43.598809-07:00","closed_at":"2026-02-13T15:21:43.598809-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-1b9","depends_on_id":"contextflow-8yw","type":"blocks","created_at":"2026-02-13T13:34:19.539096-07:00","created_by":"Paul Rayner"}]}
{"id":"contextflow-1io","title":"Add tagline to ProjectListPage header","description":"Add a subtitle under 'ContextFlow' in the header of ProjectListPage.tsx: 'Visualize bounded contexts, team ownership, and value flow together for effective strategy'. Style it as a lighter, smaller text line below the app name, matching the pattern in EventStormer (see screenshot). File: src/components/ProjectListPage.tsx","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-17T07:39:24.155368-07:00","created_by":"Paul Rayner","updated_at":"2026-02-17T08:05:02.241734-07:00","closed_at":"2026-02-17T08:05:02.241734-07:00","close_reason":"Implemented in commit aa055b0"}
{"id":"contextflow-1k6","title":"entity-008: Large project performance test","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:21.657867+08:00","updated_at":"2025-12-03T07:50:46.874605+08:00","closed_at":"2025-12-03T07:50:46.874605+08:00","dependencies":[{"issue_id":"contextflow-1k6","depends_on_id":"contextflow-9vw","type":"blocks","created_at":"2025-12-01T18:30:36.497119+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-1kx","title":"Extract CanvasArea node components to separate files","description":"CanvasArea.tsx contains 4 node components that are self-contained React components. Extract each to its own file under src/components/nodes/:\n\n- ContextNode (375 lines, line 212-587) - bounded context visualization with tooltip rendering, drag-over handling, boundary integrity styling. The largest node component. Uses hooks: useState (hover, drag-over, tooltip), useMemo (tooltip content). Imports from store: useEditorStore selectors.\n- GroupNode (129 lines, line 1135-1264) - capability cluster blob rendering with opacity and color parsing. Contains inline parseRgbColor (extract to nodeStyles.ts in contextflow-rd7 first).\n- UserNode (112 lines, line 1267-1379) - user avatar/name display\n- UserNeedNode (89 lines, line 1382-1471) - user need card display\n\nEach file should include its own imports. After extraction, CanvasArea.tsx only needs to import them for the nodeTypes registry object (line ~2483-2488):\n  const nodeTypes = { context: ContextNode, group: GroupNode, user: UserNode, userNeed: UserNeedNode }\n\nDependencies: contextflow-rd7 should be done first so that ContextNode can import getContextNodeBorderStyle from nodeStyles.ts and GroupNode can import parseRgbColor, rather than carrying inline copies.\n\nAcceptance criteria:\n- 4 files created under src/components/nodes/\n- Each is an exact copy of the original (no logic changes)\n- nodeTypes registry updated with new imports\n- TypeScript compiles without errors\n- All existing tests still pass\n- CanvasArea.tsx reduced by ~700 lines","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-14T21:47:49.672244-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T22:17:20.374065-07:00","closed_at":"2026-02-14T22:17:20.374065-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-1kx","depends_on_id":"contextflow-rd7","type":"blocks","created_at":"2026-02-14T21:48:22.751525-07:00","created_by":"Paul Rayner"}]}
{"id":"contextflow-1yo","title":"serial-004: Implement group serialization","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:35.274535+08:00","updated_at":"2025-12-02T16:46:11.542908+08:00","closed_at":"2025-12-02T16:46:11.542908+08:00","dependencies":[{"issue_id":"contextflow-1yo","depends_on_id":"contextflow-nkb","type":"blocks","created_at":"2025-12-01T17:59:58.476092+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-25m","title":"serial-007: Implement viewConfig and temporal serialization","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:42.130285+08:00","updated_at":"2025-12-02T16:51:32.840984+08:00","closed_at":"2025-12-02T16:51:32.840984+08:00","dependencies":[{"issue_id":"contextflow-25m","depends_on_id":"contextflow-ls6","type":"blocks","created_at":"2025-12-01T18:00:08.726773+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-25p","title":"Repo sidebar search missing count indicator (Teams tab has one)","description":"RepoSidebar already has a count indicator (src/components/RepoSidebar.tsx:54-58):\n`{filteredRepos.length} of {repos.length} repos`\n\nThis was found to already exist during review. This issue is invalid, close it.\n\nWait - actually re-reading the code, RepoSidebar DOES have this at lines 54-58. The original report was wrong. Closing.","status":"closed","priority":2,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-16T11:46:10.072537-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T13:21:05.333617-07:00","closed_at":"2026-02-16T13:21:05.333617-07:00","close_reason":"Invalid: RepoSidebar already has count indicator at lines 54-58 showing 'X of Y repos' when filtering. Code review was incorrect."}
{"id":"contextflow-2c3","title":"ui-013: Performance verification vs baseline","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:54:18.167548+08:00","updated_at":"2025-12-03T10:58:20.721258+08:00","closed_at":"2025-12-03T10:58:20.721258+08:00","dependencies":[{"issue_id":"contextflow-2c3","depends_on_id":"contextflow-1k6","type":"blocks","created_at":"2025-12-01T18:33:43.390405+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-2c3","depends_on_id":"contextflow-zaj","type":"blocks","created_at":"2025-12-01T18:33:43.570317+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-2ko","title":"ui-007: Create offline blocking modal","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:54:07.642502+08:00","updated_at":"2025-12-03T07:59:50.800707+08:00","closed_at":"2025-12-03T07:59:50.800707+08:00","dependencies":[{"issue_id":"contextflow-2ko","depends_on_id":"contextflow-581","type":"blocks","created_at":"2025-12-01T18:31:15.459703+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-2si","title":"Remove empty built-in project","description":"## Task\n\nRemove the Empty Project from the built-in project list. Users can now create empty projects via the 'New Project' button, so the built-in empty project is redundant clutter.\n\n## Files to modify\n\n**Core changes:**\n- `src/model/builtInProjects.ts` - Remove `emptyProject` import (line 4), remove from `TEMPLATE_PROJECTS` (line 12), update destructuring on line 22 to `[sampleProject, cbioportal, elanWarranty]`, remove `empty` export\n- `src/model/builtInProjects.ts` - Simplify `determineProjectOrigin`: remove the `'empty'` case (`project.name === 'Empty Project'` check on line 86). The return type can drop `'empty'`, or keep it if analytics backward compat matters.\n- `src/model/actions/projectHelpers.ts` - Simplify `isSampleProject` to just `return project.isBuiltIn === true` (the `!== 'Empty Project'` guard is no longer needed)\n\n**Test updates:**\n- `src/model/builtInProjects.test.ts` - Remove 'should include empty project' test (line 43-46), update/remove 'returns empty for Empty Project' test (line 212-214)\n- `src/model/actions/projectHelpers.test.ts` - Update `isSampleProject` tests: remove 'returns false for Empty Project even when built-in' test (line 78-83)\n- `src/model/templateProjects.test.ts` - Remove 'returns Empty Project template' test (line 35-39)\n- `src/model/__tests__/store.analytics.test.ts` - Remove/update 'tracks project_opened with empty origin for Empty Project' test (line 131-144)\n- `src/model/sync/__tests__/importExport.test.ts` - Remove tests referencing `empty.project.json` (lines 425-441), remove import on line 5\n\n**Optional cleanup:**\n- `examples/empty.project.json` - Can delete or keep as reference. Deleting is cleaner since it is no longer imported anywhere.\n\n## Acceptance criteria\n\n- Empty Project no longer appears in the project list\n- 'New Project' button remains the way to create empty projects\n- All tests pass\n- No dead imports or references to the removed project","status":"closed","priority":3,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-16T16:32:51.476678-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T16:48:50.120663-07:00","closed_at":"2026-02-16T16:48:50.120663-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-2si","depends_on_id":"contextflow-mxa","type":"blocks","created_at":"2026-02-16T16:35:29.706403-07:00","created_by":"Paul Rayner"}]}
{"id":"contextflow-30w","title":"Improve guidance UX: rethink onboarding flow","description":"## Goal\nReplace the current modal-heavy onboarding (WelcomeModal -\u003e Getting Started Guide) with a project list landing page, similar to EventStormer's approach.\n\n## Current Flow (problems)\n1. First load: WelcomeModal asks user to choose between creating a project or exploring a sample\n2. After choice: Getting Started Guide modal appears with step-by-step instructions\n3. Two modals before the user ever sees a canvas\n4. No 'home' to return to; you're always inside a project\n\n## Proposed Direction: Project List as Home Page\n\nAdd a project list page at the root route that shows:\n- App name/branding and brief tagline\n- 'Create New Project' button (primary CTA)\n- Grid of existing projects (name, last opened)\n- Sample projects section (clearly labeled as samples, explorable)\n- Join/open shared project option (paste URL or room ID)\n\nFlow becomes: Project List -\u003e Canvas. No modals blocking the first impression.\n\n## Items to preserve or relocate\n\n### WelcomeModal content\nThe current WelcomeModal (src/components/WelcomeModal.tsx) contains:\n- Feature summary (4-item grid: map parts, show dependencies, connect to user needs, identify importance)\n- Project creation flow\n- Sample project selection (ACME E-Commerce, Elan Warranty, cBioPortal)\n\nThe project list page absorbs all of this naturally:\n- Feature summary becomes the page's hero/tagline area (or is cut if the samples demonstrate value better)\n- Project creation becomes the CTA button\n- Sample projects become cards in the project list\n\n### Getting Started Guide\nKeep the Getting Started Guide (src/components/GettingStartedGuideModal.tsx). Do NOT remove it. Surface it via an inline canvas prompt (see contextflow-g85) and keep it accessible from Settings \u003e Help.\n\n### State to clean up\n- Remove hasSeenWelcome from store and localStorage\n- Remove WelcomeModal component\n- Remove or refactor shouldShowGettingStartedGuide() in src/model/actions/projectHelpers.ts (auto-open logic moves to contextflow-g85)\n- Remove dismissWelcome()/resetWelcome() from store\n- Update SettingsHelp to remove 'Welcome Guide' reset button\n\n## Design considerations\n- Follow the EventStormer pattern: minimal ceremony, project list IS the welcome\n- Respect 'the diagram is the UI' principle: get users to the canvas fast\n- Sample projects should be visually distinct from user projects (labeled, maybe different section)\n- Returning users should have a fast path: click project, you're in\n\n## Key files\n- src/components/WelcomeModal.tsx (to be removed)\n- src/components/GettingStartedGuideModal.tsx (kept, trigger changes)\n- src/components/CanvasArea.tsx (auto-open logic at line ~1144)\n- src/model/actions/projectHelpers.ts (shouldShowGettingStartedGuide)\n- src/model/store.ts (hasSeenWelcome, dismissWelcome, resetWelcome)\n- src/components/settings/SettingsHelp.tsx (Welcome Guide reset button)\n\n## Related beads\n- contextflow-g85: Empty canvas prompt (replaces auto-open Getting Started Guide)\n- contextflow-81o: Top bar layout swap (related UX improvement)\n- contextflow-ywr: Add button reorder (related UX improvement)","notes":"## Design Decisions (2026-02-16)\n\n1. **Navigation back**: Home button in the top bar (EventStormer pattern), not logo click\n2. **Hero/tagline**: Cut for now. Project list page is just the list. May revisit in a later bead.\n3. **Shared project URLs**: Bypass the project list, go straight to canvas (it's an invite to a specific project)\n4. **Active project on load**: No active project on start. Project list is the landing page. User picks a project to enter the workspace. Same pattern as EventStormer.","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-16T08:29:43.631712-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T09:40:23.495122-07:00","closed_at":"2026-02-16T09:40:23.495122-07:00","close_reason":"Closed"}
{"id":"contextflow-33y","title":"CRITICAL: Add persistence to YjsRoom - data lost on redeploy","description":"The y-partyserver library only keeps Yjs documents in memory by default. Without implementing onLoad and onSave methods in YjsRoom, ALL production data is lost when:\n- The Durable Object is evicted from memory\n- The worker is redeployed  \n- All clients disconnect and the DO hibernates\n\nCurrent state in workers/server.ts:\n```typescript\nexport class YjsRoom extends YServer {\n  // YServer handles all Yjs sync protocol automatically\n  // BUT NO PERSISTENCE - DATA IS LOST!\n}\n```\n\nFix required:\n1. Implement onLoad() to restore document from Durable Object storage (SQLite)\n2. Implement onSave() to persist document to storage after edits\n3. Use debouncing (2s wait, 10s max) to avoid excessive writes\n\nReference: Same issue was found and fixed in EventStormer.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-03T08:34:16.738951+08:00","updated_at":"2025-12-03T08:49:44.036549+08:00","closed_at":"2025-12-03T08:49:44.036549+08:00"}
{"id":"contextflow-36l","title":"Extract ProjectListContent from ProjectListModal","description":"Extract the inner content of ProjectListModal (search box, project cards, actions) into a reusable ProjectListContent component. Both the modal and the new ProjectListPage will compose around it.\n\n## Implementation\n- Create src/components/ProjectListContent.tsx: Props same as ProjectListModal minus onClose. Contains search, project card list, create/rename/delete/duplicate/share actions.\n- Refactor ProjectListModal.tsx to wrap ProjectListContent in modal chrome (backdrop, header with close button, 'Projects' title, 'New Project' button).\n\n## Files\n- src/components/ProjectListContent.tsx (new)\n- src/components/ProjectListModal.tsx (refactor)\n\n## Tests\n- Verify ProjectListContent renders cards, search filters work, action callbacks fire\n- Verify ProjectListModal still works identically after refactor\n\n## Part of contextflow-30w (project list landing page)","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-16T09:29:44.923829-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T10:06:47.023622-07:00","closed_at":"2026-02-16T10:06:47.023622-07:00","close_reason":"Implemented in commit 089feb7"}
{"id":"contextflow-38h","title":"Complete createSelectionState adoption across codebase","description":"w4z adopted createSelectionState in 7 selection setters and 4 of 5 lifecycle functions, but gaps remain.\n\n**Gaps in store.ts:**\n- `createProject` (~line 281-298) doesn't clear selections at all (other lifecycle functions do)\n- `setSelectedTeam` (~line 495-499) uses an inconsistent conditional pattern instead of matching the other 6 setters\n- Delete handlers (deleteContext, deleteGroup, deleteRelationship, deleteTeam, deleteUser, deleteUserNeed) use manual inline `selectedXxxId: null` patterns\n- `addTeam` (~line 599-605) clears only some selection fields manually\n\n**Gaps in components (lower priority, follow-up):**\n- CanvasArea.tsx (~lines 465-475, 484-494, 516, 522): manual 9-10 field selection clearing\n- RelationshipEdge.tsx (~lines 267-274): manual 8-field selection clearing\n- teamActions.ts (~lines 9-22, 86-90): manual selection clearing in 3 locations\n\n**Work needed:**\n1. Add `createSelectionState(null, 'context')` to `createProject` selection clearing\n2. Standardize `setSelectedTeam` to match other setter patterns\n3. Replace manual clearing in delete handlers with createSelectionState\n4. Sweep component files to use createSelectionState (or a thin wrapper like `clearAllSelections()`)\n5. Verify no behavioral changes","status":"closed","priority":3,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-14T22:25:16.934443-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T22:39:31.533192-07:00","closed_at":"2026-02-14T22:39:31.533192-07:00","close_reason":"Closed"}
{"id":"contextflow-3d1","title":"Wire context hover tooltip into ContextNode","description":"## Goal\n\nAdd a hover tooltip to ContextNode that shows view-mode-aware content using the pure functions from contextflow-vlf.\n\n## Behavior\n\n- Only shown when showHelpTooltips is enabled\n- Appears after 500ms hover delay (avoids flash during normal mouse movement)\n- Disappears immediately on mousedown (no interference with drag/connect)\n- Disappears on mouse leave\n- Positioned above the node, offset so it does not obscure the node content\n- Does not interfere with existing hover behavior (relationship highlighting, handle scaling)\n\n## Implementation\n\nIn ContextNode (src/components/CanvasArea.tsx):\n- Add a delayed hover state (500ms timeout via useRef/useEffect)\n- On hover timeout, render a tooltip div positioned above the node using createPortal\n- Call getContextTooltipLines() from src/lib/contextTooltip.ts to get content\n- Render each line as a row in the tooltip\n- Clear timeout and hide tooltip on mousedown or mouse leave\n\nTooltip styling: bg-white/90 dark:bg-neutral-800/90, border, shadow-sm, rounded, text-xs. Last line (guidance) in italic muted color. Context name as bold header.\n\n## Files to modify\n\n- src/components/CanvasArea.tsx - ContextNode component\n\n## Acceptance criteria\n\n- Tooltip appears after 500ms hover on a context node\n- Content matches current view mode (flow/distillation/strategic)\n- Tooltip hidden when showHelpTooltips is off\n- No interference with drag, connect, or relationship hover highlighting\n- Tooltip disappears on mousedown and mouse leave\n- No flicker during normal mouse movement across the canvas","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-14T09:51:48.72007-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T10:11:10.220422-07:00","closed_at":"2026-02-14T10:11:10.220422-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-3d1","depends_on_id":"contextflow-vlf","type":"blocks","created_at":"2026-02-14T09:51:58.450644-07:00","created_by":"Paul Rayner"}]}
{"id":"contextflow-3dn","title":"Implement CollabUndoManager (TDD green phase)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-02T18:10:22.195643+08:00","updated_at":"2025-12-02T18:11:51.349999+08:00","closed_at":"2025-12-02T18:11:51.349999+08:00"}
{"id":"contextflow-3q4","title":"Redundant Home button and project dropdown both navigate to project list","description":"The Home button clears activeProject (navigating to ProjectListPage), while the project name dropdown opens ProjectListModal. Both let users switch projects through different UI patterns (full page vs modal). This duplication is confusing. Options: remove the modal and have the dropdown also go to the project list page, or consolidate in another way.","status":"closed","priority":2,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-16T10:06:27.596985-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T10:10:56.706948-07:00","closed_at":"2026-02-16T10:10:56.706948-07:00","close_reason":"Closed"}
{"id":"contextflow-3qk","title":"Repo sidebar team badges missing topology label on hover","description":"Team badges in RepoSidebar (src/components/RepoSidebar.tsx:102) show topology type in the title attribute but use the raw topologyType value (e.g. 'stream-aligned') rather than the short human-readable label.\n\nCurrent code:\n`title={team.topologyType ? \\`${team.name} (${team.topologyType})\\` : team.name}`\n\nTeamSidebar (src/components/TeamSidebar.tsx:15-20) defines TOPOLOGY_LABELS:\n```\n'stream-aligned' -\u003e 'Stream'\n'platform' -\u003e 'Platform'\n'enabling' -\u003e 'Enabling'\n'complicated-subsystem' -\u003e 'Subsystem'\n```\n\nFix: Either import and use TOPOLOGY_LABELS in the title attribute, or extract the labels to a shared location (e.g. src/lib/teamColors.ts alongside getTopologyColors) and use from both files.\n\nNote: This could be combined with contextflow-d7h since both fix team badge rendering in RepoSidebar.","status":"closed","priority":2,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-16T11:46:12.17622-07:00","created_by":"Paul Rayner","updated_at":"2026-02-17T08:35:21.925964-07:00","closed_at":"2026-02-17T08:35:21.925964-07:00","close_reason":"Closed"}
{"id":"contextflow-3zy","title":"ui-014: Deploy to staging","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:54:18.369543+08:00","updated_at":"2025-12-07T20:33:05.056435+08:00","closed_at":"2025-12-07T20:33:05.056435+08:00","dependencies":[{"issue_id":"contextflow-3zy","depends_on_id":"contextflow-wqo","type":"blocks","created_at":"2025-12-01T18:33:46.600878+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-3zy","depends_on_id":"contextflow-2c3","type":"blocks","created_at":"2025-12-01T18:33:46.79047+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-4ar","title":"Extract ToggleSwitch component from TopBar","description":"TopBar.tsx (688 lines) contains 8 identical inline toggle switch implementations (lines 306, 416, 429, 445, 461, 525, 553, 577). Each is ~10 lines of identical JSX with inline styles.\n\nIMPORTANT: A Switch component already exists at src/components/Switch.tsx with the exact same visual design (h-5 w-9 rounded-full toggle). The work here is to ADOPT the existing Switch component in TopBar, not create a new one. Replace all 8 inline toggle implementations with \u003cSwitch checked={...} onCheckedChange={...} /\u003e.\n\nNote: The existing Switch uses Tailwind classes (bg-blue-600/bg-slate-300) while TopBar's inline toggles use inline styles (backgroundColor: '#3b82f6'/'#cbd5e1'). Verify the visual appearance matches after replacement; the colors are equivalent.\n\nAlso extract the settings panel sections (lines ~377-592, 215 lines total) into sub-components under src/components/settings/: SettingsViewOptions, SettingsHelp, SettingsDisplay, SettingsIntegrations.\n\nAcceptance criteria:\n- All 8 inline toggles replaced with Switch component\n- No visual regression in toggle appearance\n- Settings panel sections extracted to sub-components\n- TopBar.tsx reduced by ~150 lines\n- Existing tests still pass","status":"closed","priority":3,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-14T21:48:12.024385-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T22:17:20.386492-07:00","closed_at":"2026-02-14T22:17:20.386492-07:00","close_reason":"Closed"}
{"id":"contextflow-4xc","title":"Toggle-deselect team topology type in TeamInspector","description":"Clicking a topology type button in TeamInspector sets it, but there is no way to unset it. The app pattern for optional enums (see boundaryIntegrity in ContextInspector) allows clearing back to \"not set\". For toggle buttons, the natural affordance is: clicking the already-selected button deselects it (sets topologyType to undefined). One-line fix in TeamInspector.tsx onClick handler: if current value matches clicked value, set to undefined; otherwise set to clicked value.","status":"closed","priority":2,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-14T21:41:02.680048-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T21:42:14.475384-07:00","closed_at":"2026-02-14T21:42:14.475384-07:00","close_reason":"Closed"}
{"id":"contextflow-4xx","title":"entity-001: Migrate context mutations with tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:13.674576+08:00","updated_at":"2025-12-02T20:20:25.411982+08:00","closed_at":"2025-12-02T20:20:25.411982+08:00","dependencies":[{"issue_id":"contextflow-4xx","depends_on_id":"contextflow-qbm","type":"blocks","created_at":"2025-12-01T18:30:13.599607+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-536","title":"serial-008: Implement projectToYjs and yjsToProject","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:42.312415+08:00","updated_at":"2025-12-02T17:08:04.754635+08:00","closed_at":"2025-12-02T17:08:04.754635+08:00","dependencies":[{"issue_id":"contextflow-536","depends_on_id":"contextflow-25m","type":"blocks","created_at":"2025-12-01T18:00:12.193724+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-54j","title":"Connection handles partially hidden behind context node's rounded corners","description":"The React Flow Handle components (ContextNode.tsx:167-168) are rendered BEFORE the inner content div (line 172) in the DOM. This means the green content box paints on top of the handles, hiding their inner half:\n\n```\n            +-------------------------+\n            |                         |\n     o------|-##  Alpha               |\n     handle |##                       |\n     (blue) |                         |\n            +-------------------------+\n     \n     \u003c- only outer sliver of the blue handle is visible\n```\n\nThe user can still click the handle (cursor changes to crosshair), but it's mostly hidden behind the node so it's very hard to discover and target.\n\nFix: Add `position: relative; z-index: 1` (or similar) to the Handle components so they render above the content div. Alternatively, move the Handle elements after the inner div in the JSX, or add `z-index: 0` to the inner div.\n\nCSS hover effects in index.css:32-49 (scale 1.3x, blue color) already exist and are correct; they just can't be seen because the handles are behind the node.\n\nFiles: src/components/nodes/ContextNode.tsx:167-168 (Handle placement), line 172+ (inner div that covers them)","status":"closed","priority":2,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-16T10:46:29.082689-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T14:04:58.627708-07:00","closed_at":"2026-02-16T14:04:58.627708-07:00","close_reason":"Fixed by adding zIndex: 1 to left/right Handle components so they render above the content div"}
{"id":"contextflow-555","title":"Refactor User inspector panel","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T10:42:59.159772-07:00","updated_at":"2026-02-03T10:44:52.596765-07:00","closed_at":"2026-02-03T10:44:52.596765-07:00"}
{"id":"contextflow-581","title":"collab-001: Create useCollabStore hook structure","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:59.872326+08:00","updated_at":"2025-12-02T17:58:11.434054+08:00","closed_at":"2025-12-02T17:58:11.434054+08:00","dependencies":[{"issue_id":"contextflow-581","depends_on_id":"contextflow-z4f","type":"blocks","created_at":"2025-12-01T18:00:24.408005+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-581","depends_on_id":"contextflow-536","type":"blocks","created_at":"2025-12-01T18:00:24.578527+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-5ex","title":"Set Cloudflare billing alert (/day) + spending cap (/month)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:54:54.421692+08:00","updated_at":"2025-12-09T10:00:12.717023+08:00","closed_at":"2025-12-09T10:00:12.717023+08:00"}
{"id":"contextflow-5k3","title":"collab-003: Implement Yjs observer to Zustand sync","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:00.261112+08:00","updated_at":"2025-12-02T18:05:37.173459+08:00","closed_at":"2025-12-02T18:05:37.173459+08:00","dependencies":[{"issue_id":"contextflow-5k3","depends_on_id":"contextflow-h8m","type":"blocks","created_at":"2025-12-01T18:00:31.152652+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-5mf","title":"Extract CanvasArea edge components to separate files","description":"CanvasArea.tsx contains 4 edge components that can be extracted to src/components/edges/:\n\n- RelationshipEdge (363 lines, line 2118-2481) - the largest edge component. Renders DDD relationship patterns (ACL, OHS, shared-kernel, etc.) with complex SVG paths, pattern indicator boxes, tooltips, and a right-click context menu. Has 4-5 levels of nesting. Already uses functions from src/lib/edgeUtils.ts (getEdgeState, getEdgeStrokeWidth, getIndicatorBoxPosition) and src/lib/canvasHelpers.ts (getEdgeLabelInfo). After extraction, consider further internal decomposition as a follow-up.\n- UserConnectionEdge (70 lines, line 1474-1544) - user-to-userneed vertical connections. Uses getVerticalEdgeEndpoints from edgeUtils.ts.\n- UserNeedConnectionEdge (84 lines, line 1547-1631) - userneed-to-userneed vertical connections. Uses getVerticalEdgeEndpoints.\n- NeedContextConnectionEdge (85 lines, line 1634-1719) - userneed-to-context vertical connections. Uses getVerticalEdgeEndpoints.\n\nAll are registered in the edgeTypes object (line ~2490-2495):\n  const edgeTypes = { relationship: RelationshipEdge, userConnection: UserConnectionEdge, ... }\n\nDependencies: contextflow-rd7 should be done first so RelationshipEdge can import from edgeGeometry.ts (getEdgeParams, getBoxEdgePoint etc.) rather than relying on them being in scope from the same file.\n\nNote: RelationshipEdge references constants defined at the top of CanvasArea.tsx: EDGE_HIT_AREA_WIDTH, EDGE_STROKE_WIDTH, EDGE_TRANSITION, EDGE_DASH_ARRAY (lines 56-59), NODE_SIZES (line 47-52), and PATTERN_EDGE_INDICATORS (lines 77-106). These should be moved to a shared constants file (e.g., src/lib/canvasConstants.ts) or co-located with the edge components.\n\nAcceptance criteria:\n- 4 files created under src/components/edges/\n- Shared constants extracted to accessible location\n- edgeTypes registry updated with new imports\n- TypeScript compiles without errors\n- All existing tests still pass\n- CanvasArea.tsx reduced by ~600 lines","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-14T21:47:54.1868-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T22:17:20.37713-07:00","closed_at":"2026-02-14T22:17:20.37713-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-5mf","depends_on_id":"contextflow-rd7","type":"blocks","created_at":"2026-02-14T21:48:22.795031-07:00","created_by":"Paul Rayner"}]}
{"id":"contextflow-6jg","title":"Add duplicate project pure functions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T14:02:27.224369+08:00","updated_at":"2025-11-30T14:05:55.128549+08:00","closed_at":"2025-11-30T14:05:55.128549+08:00","dependencies":[{"issue_id":"contextflow-6jg","depends_on_id":"contextflow-lfn","type":"blocks","created_at":"2025-11-30T14:02:46.999634+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-6p9","title":"Phase 1: Direct outreach - 20 DDD practitioner conversations","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:54:54.370733+08:00","updated_at":"2025-12-09T10:00:12.716324+08:00","closed_at":"2025-12-09T10:00:12.716324+08:00"}
{"id":"contextflow-6pn","title":"Fix contradictory ownership UX: green color implies 'Our Team' but tooltip says unset","description":"When a new context is created with no ownership set, default it to 'ours' so the green color and tooltip are consistent. Set ownership: 'ours' at context creation time. Update any tests that check for unset ownership.","status":"closed","priority":2,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-16T10:19:52.396565-07:00","created_by":"Paul Rayner","updated_at":"2026-02-17T08:35:21.922896-07:00","closed_at":"2026-02-17T08:35:21.922896-07:00","close_reason":"Closed"}
{"id":"contextflow-7f6","title":"Sidebar search for repos and teams","description":"Add search/filter inputs to the left sidebar so users can quickly find repos and teams in large projects.\n\n## Scope (this bead)\n- Filter input in the Repos tab (filters unassigned repo list by name)\n- Filter input in the Teams tab (filters team list by name)\n- Simple case-insensitive text matching on entity names\n\n## Out of scope (future beads)\n- Canvas-level context search with Cmd+K (separate feature)\n- Property-based filtering (by ownership, classification, team assignment)\n- Cross-entity search modal\n\n## Implementation\n\n### Pattern to follow\nProjectListModal.tsx already implements this exact pattern:\n```typescript\nconst [searchQuery, setSearchQuery] = React.useState('')\nconst filtered = React.useMemo(() =\u003e {\n  if (!searchQuery.trim()) return allItems\n  const query = searchQuery.toLowerCase()\n  return allItems.filter(item =\u003e item.name.toLowerCase().includes(query))\n}, [allItems, searchQuery])\n```\n\n### Repos tab (RepoSidebar.tsx)\n- Add a search input above the repo list\n- Filter `repos` prop by name (and optionally remoteUrl) as user types\n- Show result count (e.g., \"3 of 12 repos\")\n- Show empty state when no repos match: \"No repos match your search\"\n- Clear button (X icon) to reset filter\n- Use lucide-react Search and X icons\n\n### Teams tab (TeamSidebar.tsx)\n- Same pattern: search input above team list\n- Filter `teams` prop by name\n- Show result count and empty state\n- Clear button to reset filter\n\n### State management\n- Search query is local component state (useState), NOT in the Zustand store\n- Search state is NOT part of undo/redo history\n- Search query resets when switching sidebar tabs\n- Search query persists within a tab while typing\n\n### Styling\n- Match existing sidebar input styling (see the inline \"Add team\" input in TeamSidebar)\n- Use Tailwind dark: classes for dark mode\n- Compact input that does not take too much vertical space\n\n## Acceptance criteria\n- Typing in Repos tab search filters the repo list in real time\n- Typing in Teams tab search filters the team list in real time\n- Matching is case-insensitive\n- Empty search shows all items (no filtering)\n- Clear button resets the filter and shows all items\n- Empty state message when no results match\n- Dark mode supported\n- Search inputs do not interfere with keyboard shortcuts (stopPropagation on the input)","status":"closed","priority":3,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-15T17:53:32.73743-07:00","created_by":"Paul Rayner","updated_at":"2026-02-15T18:18:08.087478-07:00","closed_at":"2026-02-15T18:18:08.087478-07:00","close_reason":"Closed"}
{"id":"contextflow-806","title":"ui-005: Update ProjectCreateDialog for cloud","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:53:58.925292+08:00","updated_at":"2025-12-02T21:38:37.111319+08:00","closed_at":"2025-12-02T21:38:37.111319+08:00","dependencies":[{"issue_id":"contextflow-806","depends_on_id":"contextflow-581","type":"blocks","created_at":"2025-12-01T18:31:07.031076+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-81o","title":"Swap top bar layout: move add buttons before view toggle","description":"Swap the top bar layout so add buttons come before the view toggle.\n\n## Current layout (left to right)\nLogo | Project Name | View Toggle (Value Stream/Distillation/Strategic) | ... gap ... | Add Buttons (+Stage +User +Need +Context) | Undo/Redo | Share/Export/Import | Cloud | Settings\n\n## Proposed layout\nLogo | Project Name | Add Buttons | ... gap ... | View Toggle | Undo/Redo | Share/Export/Import | Cloud | Settings\n\nThe add buttons are the primary creation actions but they're currently buried on the far right. Moving them next to the project name makes them more prominent and discoverable, especially for new users doing brownfield context mapping.\n\n## Key file\n- src/components/TopBar.tsx (lines ~253-294 for add buttons, lines ~213-250 for view toggle)\n\n## Related\n- contextflow-ywr: Reorder the add buttons themselves (Context first). Can be done in the same commit.","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-16T08:59:28.188412-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T09:11:25.023098-07:00","closed_at":"2026-02-16T09:11:25.023098-07:00","close_reason":"Closed"}
{"id":"contextflow-8f7","title":"entity-004: Migrate Flow View entity mutations with tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:14.213856+08:00","updated_at":"2025-12-02T20:20:25.644727+08:00","closed_at":"2025-12-02T20:20:25.644727+08:00","dependencies":[{"issue_id":"contextflow-8f7","depends_on_id":"contextflow-rty","type":"blocks","created_at":"2025-12-01T18:30:23.112001+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-8un","title":"Phase 1: Create Stripe Payment Link ()","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:54:54.274865+08:00","updated_at":"2025-12-09T10:00:12.715226+08:00","closed_at":"2025-12-09T10:00:12.715226+08:00"}
{"id":"contextflow-8vb","title":"Manual testing for cloud sync release","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T11:44:37.032514+08:00","updated_at":"2026-02-13T11:07:49.298088-07:00","closed_at":"2026-02-13T11:07:49.298088-07:00","close_reason":"Manual inspection completed"}
{"id":"contextflow-8wq","title":"HIGH: No retry logic on cloud upload/download failures","description":"Migration uses simple timeout-based operations with no retry mechanism:\n- If upload fails at 29 seconds, no retry\n- Temporary network glitches cause permanent migration failure\n- Migration can complete partially but be marked as failed\n\nLocation: src/model/migrations/cloudUploader.ts (lines 9-51, 54-100)\n\nNeed to implement exponential backoff + retry for cloud operations.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-03T08:38:23.992866+08:00","updated_at":"2025-12-03T09:07:18.887132+08:00","closed_at":"2025-12-03T09:07:18.887132+08:00"}
{"id":"contextflow-8yw","title":"Audit all store mutations for Yjs bypass (sync overwrite risk)","description":"## Problem\n\nThe issue CRUD bug (contextflow-co0) revealed that any store mutation writing directly to Zustand without going through Yjs will be silently overwritten when SyncManager's observeDeep fires. Full audit found 3 at-risk mutations.\n\n## At-Risk Mutations\n\n### 1. `setViewMode` distillation redistribution (P1)\n- **Location**: `src/model/store.ts` lines 203-222\n- **Risk**: When switching to distillation view with `needsRedistribution()` true, directly writes context `positions.distillation` and `strategicClassification` to Zustand and IndexedDB, bypassing Yjs. Next sync overwrites these values.\n- **Fix**: Replace direct Zustand write with a loop calling `getCollabMutations().updateContextPosition()` and `getCollabMutations().updateContext()` for each redistributed context.\n\n### 2. `renameProject` (P2)\n- **Location**: `src/model/store.ts` lines 394-398\n- **Risk**: Calls `renameProjectAction()` which writes project `name` directly to Zustand. Project name IS synced via Yjs (`projectSync.ts` line 51/90). Next sync reverts the name.\n- **Fix**: Add `renameProject(name)` to `CollabMutations` that calls `yProject.set('name', name)`.\n\n### 3. `importProject` (P3)\n- **Location**: `src/model/store.ts` lines 1026-1054\n- **Risk**: Imported project lands in Zustand/IndexedDB but not Yjs. Lower risk since imports typically create new IDs and `setActiveProject` later initializes Yjs properly.\n- **Fix**: After import, re-initialize collab mode (follow `createProject`/`createFromTemplate` pattern).\n\n## Acceptance Criteria\n- [ ] All 3 mutations route through Yjs\n- [ ] Tests cover each fixed mutation\n- [ ] Verify in browser: rename persists after sync, distillation redistribution persists, import works in collab mode","status":"closed","priority":1,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-13T13:28:19.850397-07:00","created_by":"Paul Rayner","updated_at":"2026-02-13T13:55:36.46787-07:00","closed_at":"2026-02-13T13:55:36.46787-07:00","close_reason":"All 3 at-risk mutations now route through Yjs: distillation redistribution, renameProject, importProject. 5 new tests, 1331 total passing."}
{"id":"contextflow-95w","title":"serial-001: Design Yjs schema with type definitions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:34.717045+08:00","updated_at":"2025-12-02T16:23:05.144551+08:00","closed_at":"2025-12-02T16:23:05.144551+08:00","dependencies":[{"issue_id":"contextflow-95w","depends_on_id":"contextflow-wpv","type":"blocks","created_at":"2025-12-01T17:59:22.44903+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-99t","title":"ui-008: Simplify ProjectListModal for cloud","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:54:07.822781+08:00","updated_at":"2025-12-03T08:12:04.280049+08:00","closed_at":"2025-12-03T08:12:04.280049+08:00","dependencies":[{"issue_id":"contextflow-99t","depends_on_id":"contextflow-hl8","type":"blocks","created_at":"2025-12-01T18:31:30.893069+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-99t","depends_on_id":"contextflow-581","type":"blocks","created_at":"2025-12-01T18:31:31.091205+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-9bf","title":"Show connection handles only on hover","description":"Connection handles (left/right dots) on context nodes are always visible at 70% opacity, adding visual clutter. Change to show handles only when hovering a context node. Handles should be invisible by default (opacity 0) and appear on hover. The existing connecting state (pulsing blue) should still work.","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-17T08:01:23.582691-07:00","created_by":"Paul Rayner","updated_at":"2026-02-17T08:02:00.514186-07:00","closed_at":"2026-02-17T08:02:00.514186-07:00","close_reason":"Changed default handle opacity from 0.7 to 0 in index.css"}
{"id":"contextflow-9ma","title":"Add tagline and Examples section to project landing page","description":"Add descriptive tagline under ContextFlow header. Split project list into user projects and examples sections with descriptions.","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-17T07:41:46.404098-07:00","created_by":"Paul Rayner","updated_at":"2026-02-17T07:41:53.03277-07:00","closed_at":"2026-02-17T07:41:53.03277-07:00","close_reason":"Implemented tagline and split project list into user/example sections"}
{"id":"contextflow-9ub","title":"ui-002: Add CloudStatusIndicator to TopBar","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:53:58.36424+08:00","updated_at":"2025-12-02T21:36:01.181178+08:00","closed_at":"2025-12-02T21:36:01.181178+08:00","dependencies":[{"issue_id":"contextflow-9ub","depends_on_id":"contextflow-bo5","type":"blocks","created_at":"2025-12-01T18:30:57.601713+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-9vw","title":"entity-007: Import/export compatibility with tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:21.435183+08:00","updated_at":"2025-12-03T07:03:42.059056+08:00","closed_at":"2025-12-03T07:03:42.059056+08:00","dependencies":[{"issue_id":"contextflow-9vw","depends_on_id":"contextflow-g4s","type":"blocks","created_at":"2025-12-01T18:30:33.325799+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-9xi","title":"infra-004: Add VITE_COLLAB_HOST environment configuration","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:14.562703+08:00","updated_at":"2025-12-02T16:14:07.495613+08:00","closed_at":"2025-12-02T16:14:07.495613+08:00","dependencies":[{"issue_id":"contextflow-9xi","depends_on_id":"contextflow-wpv","type":"blocks","created_at":"2025-12-01T17:59:02.995447+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-ab5","title":"Extract CanvasArea overlay components to separate files","description":"CanvasArea.tsx contains 8 canvas overlay components that render visual layers on the React Flow canvas. Extract to src/components/overlays/:\n\n- DistillationRegions (278 lines, line 1837-2115) - largest overlay. Renders distillation view grid lines, region backgrounds, axis labels. Has 5-level nesting in grid line rendering. Uses useViewport() and useReactFlow() hooks.\n- StageLabels (124 lines, line 590-714) - flow stage labels positioned above canvas with drag interaction for reordering. Uses useViewport().\n- IssueLabelsOverlay (136 lines, line 768-904) - floating issue severity badges below context nodes. Uses useViewport(). Has zoom \u003c 0.4 cutoff.\n- TeamLabelsOverlay (104 lines, line 907-1011) - team assignment badges above context nodes. Uses useViewport(). Has zoom \u003c 0.4 cutoff. Contains inline topologyColors constant.\n- EvolutionBands (96 lines, line 1014-1110) - Wardley evolution zone backgrounds (Genesis, Custom, Product, Commodity). Uses useViewport().\n- ProblemSpaceBand (20 lines, line 1112-1132) - simple problem space region indicator. Uses useViewport().\n- StageBoundaryLines (48 lines, line 717-765) - vertical boundaries between flow stages. Uses useViewport().\n- CanvasBoundary (52 lines, line 1722-1774) - canvas boundary rectangle. Uses useViewport().\n- YAxisLabels (57 lines, line 1777-1834) - Y-axis labels for canvas. Uses useViewport().\n\nCommon patterns that could be shared:\n- Position transformation: `const transformed = position * zoom + viewportOffset` appears in every overlay\n- Zoom-based font scaling: `fontSize: Math.max(minSize, baseSize / zoom)` appears in 4+ overlays\n- Zoom visibility cutoff: `if (zoom \u003c threshold) return null` appears in 2 overlays\n\nThese could go in a small overlayUtils.ts, but that's optional. The primary goal is file separation.\n\nNote: All overlays use useViewport() from 'reactflow', which only works inside a \u003cReactFlowProvider\u003e. They are rendered as children of \u003cReactFlow\u003e in CanvasContent, so this continues to work after extraction.\n\nAcceptance criteria:\n- 9 files created under src/components/overlays/ (corrected from 8 - includes ProblemSpaceBand)\n- Each is an exact copy of the original\n- CanvasContent imports and renders them by name\n- TypeScript compiles without errors\n- All existing tests still pass\n- CanvasArea.tsx reduced by ~900 lines","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-14T21:48:01.090001-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T22:17:20.379843-07:00","closed_at":"2026-02-14T22:17:20.379843-07:00","close_reason":"Closed","dependencies":[{"issue_id":"contextflow-ab5","depends_on_id":"contextflow-rd7","type":"blocks","created_at":"2026-02-14T21:48:22.838452-07:00","created_by":"Paul Rayner"}]}
{"id":"contextflow-agv","title":"serial-002: Implement contextToYMap and yMapToContext","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:34.908644+08:00","updated_at":"2025-12-02T16:38:07.196763+08:00","closed_at":"2025-12-02T16:38:07.196763+08:00","dependencies":[{"issue_id":"contextflow-agv","depends_on_id":"contextflow-95w","type":"blocks","created_at":"2025-12-01T17:59:27.110728+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-al0","title":"Extract ContextInspector relationship and issue sections","description":"ContextInspector.tsx (678 lines) has areas of significant duplication that should be consolidated.\n\n**1. Relationship rendering (lines 496-651, ~155 lines)**\nThree nearly identical blocks for upstream (line 519), downstream (line 559), and mutual (line 599) relationships. Each has the same structure: section header -\u003e map over relationships -\u003e render row with context name, pattern label, optional description, and delete button. Extract to a RelationshipGroup sub-component with props: title, relationships, contexts, onDelete, directionIcon.\n\nNote: The upstream block uses ArrowRight icon, downstream uses ArrowLeft, and mutual uses ArrowLeftRight. The target context lookup differs (upstream uses rel.toContextId, downstream uses rel.fromContextId, mutual checks both). Ensure the sub-component handles these variations via props.\n\nAlso note: lines 548, 588, 629 use native title=\"Delete relationship\" which violates CLAUDE.md convention. Replace with SimpleTooltip during extraction.\n\n**2. Issue severity buttons (lines 418-453)**\nThree identical button structures for info/warning/critical severity. Each is ~10 lines with the same structure: SimpleTooltip wrapping a button with conditional background/text color classes. Extract to an IssueSeverityButton sub-component with props: severity, isActive, onClick, tooltipText, Icon.\n\nSeverity config to extract as a constant:\n- info: { bg: 'blue', icon: Info, tooltip: 'Info: General note' }\n- warning: { bg: 'amber', icon: AlertTriangle, tooltip: 'Warning: Needs attention' }\n- critical: { bg: 'red', icon: AlertOctagon, tooltip: 'Critical: Urgent problem' }\n\n**3. Connected users logic (lines 84-115)**\nIIFE with 4-level filtering chain to find users connected to a context via user needs. Extract to a pure function:\n  getConnectedUsers(project: Project, contextId: string): User[]\nPlace in src/lib/inspectorHelpers.ts (or similar). This is independently testable.\n\n**4. Relationship categorization (lines 496-506)**\nThe upstream/downstream/mutual filtering logic is a pure function candidate:\n  categorizeRelationships(relationships: Relationship[], contextId: string): { upstream, downstream, mutual }\nPlace alongside getConnectedUsers.\n\nAcceptance criteria:\n- RelationshipGroup sub-component handles all 3 variants\n- IssueSeverityButton sub-component replaces 3 inline buttons\n- getConnectedUsers and categorizeRelationships are pure functions with tests\n- No native title attributes remain (use SimpleTooltip)\n- All existing tests still pass\n- ContextInspector.tsx reduced by ~100-150 lines","status":"closed","priority":3,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-14T21:48:17.510279-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T22:17:20.38364-07:00","closed_at":"2026-02-14T22:17:20.38364-07:00","close_reason":"Closed"}
{"id":"contextflow-atz","title":"Display names on context relationships","description":"Relationship edges need visible labels showing the relationship pattern name. Eric Evans first-use feedback - he couldn't tell what the relationship was without clicking on it.","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-13T11:23:25.543947-07:00","created_by":"Paul Rayner","updated_at":"2026-02-13T15:16:11.552166-07:00","closed_at":"2026-02-13T15:16:11.552166-07:00","close_reason":"Closed"}
{"id":"contextflow-b14","title":"entity-002: Migrate relationship mutations with tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:13.854136+08:00","updated_at":"2025-12-02T20:20:25.502385+08:00","closed_at":"2025-12-02T20:20:25.502385+08:00","dependencies":[{"issue_id":"contextflow-b14","depends_on_id":"contextflow-4xx","type":"blocks","created_at":"2025-12-01T18:30:16.578696+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-b7e","title":"Create ProjectListPage component","description":"Full-page landing view wrapping ProjectListContent. Simple header with 'ContextFlow' + version tooltip + 'New Project' button. No TopBar on this page.\n\n## Implementation\n- Create src/components/ProjectListPage.tsx\n- Read projects/createProject/setActiveProject/deleteProject/renameProject/duplicateProject from store\n- Render header area + ProjectListContent\n- onSelectProject calls setActiveProject\n- onCreateProject calls createProject\n- Follow EventStormer's BoardList pattern but simpler (no hero, no join-by-room)\n\n## Files\n- src/components/ProjectListPage.tsx (new)\n\n## Tests\n- Renders project list\n- Clicking a card calls setActiveProject\n- 'New Project' creates a project\n\n## Part of contextflow-30w (project list landing page)","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-16T09:29:52.463121-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T10:06:51.024067-07:00","closed_at":"2026-02-16T10:06:51.024067-07:00","close_reason":"Implemented in commit 089feb7","dependencies":[{"issue_id":"contextflow-b7e","depends_on_id":"contextflow-36l","type":"blocks","created_at":"2026-02-16T09:30:39.989653-07:00","created_by":"Paul Rayner"}]}
{"id":"contextflow-bo5","title":"ui-001: Create CloudStatusIndicator component","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-01T17:53:58.183835+08:00","updated_at":"2025-12-02T21:32:43.769787+08:00","closed_at":"2025-12-02T21:32:43.769787+08:00","dependencies":[{"issue_id":"contextflow-bo5","depends_on_id":"contextflow-581","type":"blocks","created_at":"2025-12-01T18:30:51.005129+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-bv5","title":"Write Y.UndoManager tests (TDD red phase)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-02T18:08:18.056729+08:00","updated_at":"2025-12-02T18:10:01.757481+08:00","closed_at":"2025-12-02T18:10:01.757481+08:00"}
{"id":"contextflow-c5c","title":"Phase 1: Create Founding Partners landing page","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:54:54.225713+08:00","updated_at":"2025-12-09T10:00:12.713418+08:00","closed_at":"2025-12-09T10:00:12.713418+08:00"}
{"id":"contextflow-cls","title":"ui-009: Implement automatic migration","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-01T17:54:08.006765+08:00","updated_at":"2025-12-03T08:25:56.340638+08:00","closed_at":"2025-12-03T08:25:56.340638+08:00","dependencies":[{"issue_id":"contextflow-cls","depends_on_id":"contextflow-9vw","type":"blocks","created_at":"2025-12-01T18:31:34.557564+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-co0","title":"Fix issues/hotspots disappearing when context selected","description":"Issues/hotspots disappear from the canvas when any context is selected. Eric Evans found this during his first use session.","notes":"Reproduction steps (Paul confirmed): 1) Open empty project 2) Create new bounded context 3) Add 2 issues to it 4) See issues on canvas 5) Click on the context 6) Issues disappear. Previous investigation was with existing project data; this simpler case reproduces reliably.","status":"closed","priority":1,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-13T11:23:45.527622-07:00","created_by":"Paul Rayner","updated_at":"2026-02-13T13:23:09.92127-07:00","closed_at":"2026-02-13T13:23:09.92127-07:00","close_reason":"Fixed: issue mutations were bypassing Yjs, writing directly to Zustand. SyncManager observer would overwrite with Yjs data (no issues). Routed all issue CRUD through getCollabMutations() -\u003e Yjs."}
{"id":"contextflow-d0i","title":"collab-005: Wire up store mutations to Yjs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:00.673469+08:00","updated_at":"2025-12-02T20:03:28.845148+08:00","closed_at":"2025-12-02T20:03:28.845148+08:00","dependencies":[{"issue_id":"contextflow-d0i","depends_on_id":"contextflow-0sv","type":"blocks","created_at":"2025-12-01T18:00:38.065669+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-d7h","title":"Team badges in repo sidebar use hardcoded blue instead of topology-aware colors","description":"Team chips in RepoSidebar (src/components/RepoSidebar.tsx:98-106) use hardcoded Tailwind classes:\n`className=\"bg-blue-100 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300 ...\"`\n\nBut TeamSidebar (src/components/TeamSidebar.tsx:111,148-157) uses `getTopologyColors()` from `src/lib/teamColors.ts` with inline styles for topology-aware coloring.\n\nFix: Import `getTopologyColors` in RepoSidebar and use it for team badges, matching the TeamSidebar pattern:\n```tsx\nconst badgeColors = team.topologyType ? getTopologyColors(team.topologyType).light : null\n// Then use style={{ backgroundColor: badgeColors?.bg, color: badgeColors?.text, border: ... }}\n// with a fallback to the current blue classes when badgeColors is null\n```\n\n**Tests:** Add/update RepoSidebar tests to verify team badges use topology colors when available.","status":"closed","priority":2,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-16T11:46:07.892468-07:00","created_by":"Paul Rayner","updated_at":"2026-02-17T08:35:21.92504-07:00","closed_at":"2026-02-17T08:35:21.92504-07:00","close_reason":"Closed"}
{"id":"contextflow-dda","title":"Add Discord text link to README","description":"Add a plain text link to the Discord server in README.md so it's discoverable via browser page search (Cmd+F). Currently the Discord link may only be an icon/badge that isn't searchable by text.","status":"closed","priority":4,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-15T17:53:33.507015-07:00","created_by":"Paul Rayner","updated_at":"2026-02-15T17:57:38.9645-07:00","closed_at":"2026-02-15T17:57:38.9645-07:00","close_reason":"Discord link already exists in README as a badge"}
{"id":"contextflow-dqw","title":"ui-003: Create ShareProjectDialog component","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-01T17:53:58.550857+08:00","updated_at":"2025-12-02T21:37:59.941297+08:00","closed_at":"2025-12-02T21:37:59.941297+08:00","dependencies":[{"issue_id":"contextflow-dqw","depends_on_id":"contextflow-581","type":"blocks","created_at":"2025-12-01T18:31:00.758262+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-em3","title":"Teams sidebar panel for managing project teams","description":"## Goal\n\nAdd a Teams sidebar panel (analogous to the existing RepoSidebar) that gives teams a first-class management surface. Currently, teams can only be managed by selecting a context and editing its team assignment, or by clicking a team in the inspector. There is no master list view.\n\n## Existing Infrastructure\n\nTeam CRUD is already fully wired through collab mutations:\n- `store.addTeam(name)` / `store.deleteTeam(teamId)` / `store.updateTeam(teamId, updates)`\n- `store.setSelectedTeam(teamId)` opens TeamInspector in the right panel\n- All mutations go through `getCollabMutations()` -\u003e `metadataMutations.ts` -\u003e Yjs (sync-safe)\n- `selectedTeamId` state already exists in the store\n\nNo new store actions or mutation functions are needed. This is purely a UI component.\n\n## Behavior\n\n- A \"Teams\" tab or toggle in the left sidebar (alongside or replacing the Repos panel)\n- Shows all teams for the current project in a scrollable list\n- Each team card shows: name, topology type badge, count of assigned contexts (computed by filtering `project.contexts` where `c.teamId === team.id`)\n- Add new team inline (text input + button), calls `store.addTeam(name)`\n- Click a team to select it (`store.setSelectedTeam(teamId)`), which opens TeamInspector in the right panel\n- Delete team from the list (with confirmation if contexts are assigned), calls `store.deleteTeam(teamId)`\n- Teams can be created upfront (brainstorm all team names first) or incrementally as contexts are added\n- Empty state: show a brief message (\"No teams yet\") with the inline add input still visible\n\n## Layout Decision\n\nThe left sidebar currently only renders when there are unassigned repos. The Teams panel should be always-accessible, not conditional on repo state. Suggested approach: a tab bar or segmented toggle at the top of the left sidebar switching between \"Repos\" and \"Teams\". Both tabs share the same sidebar slot. The sidebar shows when either tab has content or is explicitly opened.\n\n## Not in scope\n\n- Many-to-many team-context relationships (1:1 teamId on BoundedContext is sufficient)\n- Drag-and-drop team assignment (that is contextflow-ocz)\n- Schema/data model changes\n- New store actions or mutations (all already exist)\n\n## Prior art\n\n- RepoSidebar (`src/components/RepoSidebar.tsx`) -- similar master list pattern for repos, uses drag-and-drop\n- TeamInspector (`src/components/inspector/TeamInspector.tsx`) -- already exists for editing a single team\n\n## Files likely affected\n\n- New: `src/components/TeamSidebar.tsx`\n- Modified: `src/App.tsx` (mount sidebar, add tab switching logic, update grid layout)\n- Modified: `src/model/store.ts` (add sidebar tab/toggle state if needed)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-11T13:08:15.624335+08:00","updated_at":"2026-02-14T21:30:59.164961-07:00","closed_at":"2026-02-14T21:30:59.164961-07:00","close_reason":"Closed"}
{"id":"contextflow-f0i","title":"Highlight connected contexts on hover","description":"When hovering over a context, highlight its relationship connections. Eric Evans feedback; extends existing selection highlight request.","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-13T11:23:37.40867-07:00","created_by":"Paul Rayner","updated_at":"2026-02-13T15:16:11.555541-07:00","closed_at":"2026-02-13T15:16:11.555541-07:00","close_reason":"Closed"}
{"id":"contextflow-g4s","title":"entity-006: Migrate viewConfig and temporal mutations with tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:14.594737+08:00","updated_at":"2025-12-02T21:13:20.280177+08:00","closed_at":"2025-12-02T21:13:20.280177+08:00","dependencies":[{"issue_id":"contextflow-g4s","depends_on_id":"contextflow-yob","type":"blocks","created_at":"2025-12-01T18:30:29.916129+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-g85","title":"Empty canvas prompt linking to Getting Started Guide","description":"When a user opens a project with an empty canvas, show an inline prompt on the canvas itself (not a modal) that links to the Getting Started Guide. This replaces the current auto-opening modal behavior.\n\n## Current behavior\nCanvasArea.tsx (line ~1144) calls shouldShowGettingStartedGuide() from projectHelpers.ts to decide whether to auto-open GettingStartedGuideModal. This fires for empty projects and first-time sample views, resulting in an intrusive modal.\n\n## Proposed behavior\nReplace the auto-open modal with a lightweight, non-blocking inline prompt rendered on the canvas. The prompt should:\n- Be visually part of the canvas, not a modal overlay\n- Link to / open the Getting Started Guide\n- Be dismissible\n- Not reappear once dismissed (persist dismissal)\n\nThe Getting Started Guide itself (GettingStartedGuideModal) is kept as-is; only the trigger mechanism changes. It also remains accessible from Settings \u003e Help \u003e Getting Started Guide.\n\n## Trigger conditions (TBD)\nExact trigger needs careful thought. Possible signals: empty canvas with no contexts, first time opening a non-sample project, user hasn't added any entities yet. Edge case to consider: a user who deliberately emptied a project shouldn't keep seeing the prompt.\n\n## Key files\n- src/components/CanvasArea.tsx (current auto-open logic at line ~1144)\n- src/model/actions/projectHelpers.ts (shouldShowGettingStartedGuide function)\n- src/model/actions/projectHelpers.test.ts (existing tests for trigger logic)\n- src/components/GettingStartedGuideModal.tsx (kept, opened by the prompt)\n\n## Related\n- contextflow-30w: Project list landing page (removes WelcomeModal, changes overall onboarding flow)","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-16T09:03:44.801759-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T10:06:47.027933-07:00","closed_at":"2026-02-16T10:06:47.027933-07:00","close_reason":"Implemented in commit 089feb7"}
{"id":"contextflow-gdf","title":"CRITICAL: Race condition in Y.Doc connection + population","description":"There's an unsafe race condition between Y.Doc population and network sync:\n\n1. Y.Doc created (empty)\n2. Network provider starts syncing remote updates\n3. populateYDocWithProject() called with placeholder\n4. Meanwhile, remote updates are being applied\n5. Both placeholder and remote state could merge incorrectly\n\nLocation: src/model/store.ts (line 1046), src/model/sync/projectSync.ts (lines 32-38)\n\nThe code checks yProject.has('id') to prevent re-population, but this check happens AFTER the placeholder is already being written. Need proper sync state checking before populating Y.Doc.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-03T08:38:23.808104+08:00","updated_at":"2025-12-03T08:57:29.382659+08:00","closed_at":"2025-12-03T08:57:29.382659+08:00","dependencies":[{"issue_id":"contextflow-gdf","depends_on_id":"contextflow-33y","type":"blocks","created_at":"2025-12-03T08:38:29.779296+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-gjx","title":"Separate examples into their own section on project list page","description":"Split ProjectListContent.tsx into two sections: user projects on top, examples below a divider.\n\nUser Projects section:\n- New Project button + search bar (existing)\n- User project cards (existing card style)\n- If no user projects exist, just show the New Project button\n\nExamples section:\n- Horizontal divider (border-t)\n- 'Examples' section header with BookOpen icon from lucide (matching EventStormer style)\n- Example cards show name + short description\n- Descriptions hardcoded in a constant map (no schema change):\n  - ACME E-Commerce Platform: 'Fictional e-commerce company with teams, repos, and value flow'\n  - cBioPortal Demo Map: 'Open-source cancer genomics platform with complex domain boundaries'\n  - Elan Extended Warranty: 'Warranty claims processing with upstream/downstream relationships'\n\nSearch filters both sections. If query matches only examples, only Examples section shows (and vice versa).\n\nFile: src/components/ProjectListContent.tsx","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-17T07:39:27.238336-07:00","created_by":"Paul Rayner","updated_at":"2026-02-17T08:05:02.243398-07:00","closed_at":"2026-02-17T08:05:02.243398-07:00","close_reason":"Implemented in commit aa055b0"}
{"id":"contextflow-gyf","title":"Wire rd7 extracted utils into components (remove dead code)","description":"rd7 extracted 8 utility functions to 3 modules with tests, but 5 were never wired into components. The inline logic was copied into the extracted component files instead of importing the utils.\n\n**Dead code (exported, only used in tests):**\n- `nodeStyles.ts`: `getContextNodeBorderStyle()` - ContextNode.tsx still has inline borderWidth/boxShadow logic\n- `nodeStyles.ts`: `parseRgbColor()` - GroupNode.tsx doesn't use it\n- `positionUtils.ts`: `getContextCanvasPosition()` - CanvasArea.tsx still has inline position mapping (~line 188-217)\n- `positionUtils.ts`: `clampDragDelta()` - CanvasArea.tsx still has inline clamping (~lines 654-675, 724-731)\n- `edgeGeometry.ts`: `getNodeIntersection()` - not imported by any component\n- `edgeGeometry.ts`: `getEdgePosition()` - not imported by any component\n\n**Duplicate constant:**\n- `NODE_SIZES` defined in both `src/lib/canvasConstants.ts` and `src/components/nodes/ContextNode.tsx`. ContextNode should import from canvasConstants.\n\n**Work needed:**\n1. Replace inline borderWidth/boxShadow logic in ContextNode.tsx with `getContextNodeBorderStyle()` import\n2. Replace inline color parsing in GroupNode.tsx with `parseRgbColor()` import (or remove from nodeStyles if GroupNode simplified it away)\n3. Replace inline position mapping in CanvasArea.tsx with `getContextCanvasPosition()` import\n4. Replace inline clamping in CanvasArea.tsx with `clampDragDelta()` import\n5. Wire `getNodeIntersection`/`getEdgePosition` into consuming code, or remove if truly unused\n6. Remove duplicate NODE_SIZES from ContextNode.tsx, import from canvasConstants\n7. Verify no behavioral changes (all existing tests pass)","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-14T22:25:06.961391-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T22:39:31.462019-07:00","closed_at":"2026-02-14T22:39:31.462019-07:00","close_reason":"Closed"}
{"id":"contextflow-h8m","title":"collab-002: Integrate y-partyserver provider","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:00.073218+08:00","updated_at":"2025-12-02T18:02:21.829736+08:00","closed_at":"2025-12-02T18:02:21.829736+08:00","dependencies":[{"issue_id":"contextflow-h8m","depends_on_id":"contextflow-581","type":"blocks","created_at":"2025-12-01T18:00:28.138848+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-hl8","title":"ui-004: Add Share button to TopBar","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:53:58.744449+08:00","updated_at":"2025-12-02T21:41:53.300112+08:00","closed_at":"2025-12-02T21:41:53.300112+08:00","dependencies":[{"issue_id":"contextflow-hl8","depends_on_id":"contextflow-9ub","type":"blocks","created_at":"2025-12-01T18:31:03.797152+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-hl8","depends_on_id":"contextflow-dqw","type":"blocks","created_at":"2025-12-01T18:31:03.98944+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-i0a","title":"infra-002: Create Cloudflare Worker with YjsRoom Durable Object","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:24.805132+08:00","updated_at":"2025-12-02T15:57:53.690038+08:00","closed_at":"2025-12-02T15:57:53.690038+08:00","dependencies":[{"issue_id":"contextflow-i0a","depends_on_id":"contextflow-wpv","type":"blocks","created_at":"2025-12-01T17:58:55.376751+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-j38","title":"Confusing duplicate hover icons on project cards","description":"Project cards show both a Link2 icon (copy share link) and a Copy icon (duplicate project) on hover. Both have copy semantics and look similar, making it hard to tell them apart. Consider differentiating visually or removing one.","status":"closed","priority":2,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-16T10:06:25.336325-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T10:10:56.705888-07:00","closed_at":"2026-02-16T10:10:56.705888-07:00","close_reason":"Closed"}
{"id":"contextflow-jpe","title":"Move relationship labels in front of relationship lines","description":"Relationship labels are currently rendered behind the relationship lines, so the line cuts through the label text. Labels should be rendered in front of (on top of) the lines so they are clearly readable without line interference.","status":"closed","priority":2,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-17T07:54:56.101041-07:00","created_by":"Paul Rayner","updated_at":"2026-02-17T07:57:16.556893-07:00","closed_at":"2026-02-17T07:57:16.556893-07:00","close_reason":"Added zIndex: 10 to edge label div in RelationshipEdge so labels render above edge lines"}
{"id":"contextflow-kel","title":"ui-010: Update demo projects to Create from Template","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:54:08.188209+08:00","updated_at":"2025-12-03T08:30:05.94182+08:00","closed_at":"2025-12-03T08:30:05.94182+08:00","dependencies":[{"issue_id":"contextflow-kel","depends_on_id":"contextflow-806","type":"blocks","created_at":"2025-12-01T18:31:37.61138+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-ksa","title":"Phase 1: Record 90-second demo video","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-08T22:54:54.32257+08:00","updated_at":"2025-12-09T10:00:12.715836+08:00","closed_at":"2025-12-09T10:00:12.715836+08:00"}
{"id":"contextflow-lfn","title":"Wire duplicate project into store and UI","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T14:02:27.402759+08:00","updated_at":"2025-11-30T14:08:33.542622+08:00","closed_at":"2025-11-30T14:08:33.542622+08:00"}
{"id":"contextflow-ls6","title":"serial-006: Implement metadata entity serialization","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:35.63248+08:00","updated_at":"2025-12-02T16:49:42.210164+08:00","closed_at":"2025-12-02T16:49:42.210164+08:00","dependencies":[{"issue_id":"contextflow-ls6","depends_on_id":"contextflow-o68","type":"blocks","created_at":"2025-12-01T18:00:05.005794+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-mxa","title":"Load user-created projects from IndexedDB at startup","description":"## Bug\n\nUser-created projects are saved to IndexedDB via `autosaveIfNeeded` but never loaded back into the store on page load. `initializeBuiltInProjects` only loads built-in projects by their (newly-generated random) IDs. This causes all user-created projects to disappear on any full page refresh or deployment.\n\nA secondary issue: the `activeProjectId` restoration (builtInProjects.ts:75-77) checks `initialProjects` which only contains newly-minted built-in IDs, so a stored user project ID never matches.\n\n## Fix\n\nModify `initializeBuiltInProjects` in `src/model/builtInProjects.ts` to:\n1. Call `loadAllProjects()` from persistence.ts (already exists, used by cloudMigration)\n2. Filter out orphaned built-in projects (`isBuiltIn: true`) since those have stale random IDs from prior sessions\n3. Apply `migrateProject()` to each loaded user project\n4. Merge user projects into the `projects` map alongside built-in projects before calling `setState`\n5. After merging, check if `localStorage.getItem('contextflow.activeProjectId')` matches any loaded project and restore it via `setState({ activeProjectId })`\n\nThe `initialActiveProjectId` export (line 77) can remain as-is for the synchronous initial render; the async load will correct it.\n\n## Files to modify\n\n- `src/model/builtInProjects.ts` - Add `loadAllProjects` import, expand `initializeBuiltInProjects` to also load user projects, restore activeProjectId\n- `src/model/__tests__/store.persistence.test.ts` - Add test for user project loading from IndexedDB\n- `src/model/builtInProjects.test.ts` - Add test for orphan filtering (isBuiltIn projects from IndexedDB are excluded)\n\n## Acceptance criteria\n\n- User-created projects persist across full page reloads\n- Built-in project orphans in IndexedDB do not appear in the project list\n- activeProjectId is correctly restored when it refers to a user project\n- Existing tests continue to pass","status":"closed","priority":1,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-16T16:32:50.009603-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T16:48:50.11837-07:00","closed_at":"2026-02-16T16:48:50.11837-07:00","close_reason":"Closed"}
{"id":"contextflow-nen","title":"HIGH: Migration cleanup deletes data before verification","description":"After 48 hours, local IndexedDB copies are deleted without verifying cloud sync actually succeeded:\n- No verification that cloud data is intact before deletion\n- If cloud deletion accidentally happens, local copy is gone\n- No recovery possible after 48 hours\n\nLocation: src/model/migrations/cloudMigration.ts (lines 136-152)\n\nNeed to add verification that cloud data matches local before deleting backups.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-03T08:38:24.179669+08:00","updated_at":"2025-12-03T09:16:10.297518+08:00","closed_at":"2025-12-03T09:16:10.297518+08:00"}
{"id":"contextflow-nkb","title":"serial-003: Implement relationship serialization","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:35.090177+08:00","updated_at":"2025-12-02T16:44:41.079178+08:00","closed_at":"2025-12-02T16:44:41.079178+08:00","dependencies":[{"issue_id":"contextflow-nkb","depends_on_id":"contextflow-agv","type":"blocks","created_at":"2025-12-01T17:59:55.126855+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-nyg","title":"HIGH: No automatic reconnection after disconnect","description":"When connection drops, state is set to 'offline' but there's no automatic reconnection attempt:\n- User is offline but app doesn't try to reconnect\n- No exponential backoff\n- Infinite zombie state possible\n\nLocation: src/model/collabStore.ts (lines 138-146)\n\nNeed to implement auto-reconnect with exponential backoff.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-03T08:38:24.364809+08:00","updated_at":"2025-12-03T09:51:34.074636+08:00","closed_at":"2025-12-03T09:51:34.074636+08:00"}
{"id":"contextflow-o68","title":"serial-005: Implement Flow View entity serialization","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:35.453579+08:00","updated_at":"2025-12-02T16:47:54.473569+08:00","closed_at":"2025-12-02T16:47:54.473569+08:00","dependencies":[{"issue_id":"contextflow-o68","depends_on_id":"contextflow-1yo","type":"blocks","created_at":"2025-12-01T18:00:01.435733+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-ocz","title":"Drag-and-drop team assignment","description":"## Goal\n\nDrag a team from the Teams sidebar and drop it onto a bounded context node to assign team ownership. This provides a fast visual alternative to the current workflow (select context -\u003e open inspector -\u003e pick team from dropdown).\n\n## Behavior\n\n- **Drag source**: team card in TeamSidebar\n- **Drop target**: any BoundedContext node on the canvas\n- Visual feedback during drag: context nodes highlight with the existing blue glow/border treatment (the `isDragOver` state already feeds into `getContextNodeBorderStyle`)\n- On drop: call `store.assignTeamToContext(contextId, teamId)` (already exists in store)\n- External contexts (`ownership === \"external\"`) should not highlight on drag-over and should reject the drop silently (the store action already returns early for external contexts, but the drop handler should also skip the visual feedback)\n- If context already has a team assigned, the drop replaces it (no confirmation needed)\n\n## Implementation Guide\n\n### 1. TeamSidebar.tsx -- add drag source\n\nAdd a `handleDragStart` function and wire it to each team card div. Follow the existing repo pattern:\n\n```tsx\nconst handleDragStart = (e: React.DragEvent, teamId: string) =\u003e {\n  e.dataTransfer.setData('application/contextflow-team', teamId)\n  e.dataTransfer.effectAllowed = 'move'\n}\n```\n\nAdd `draggable` and `onDragStart` to the team card div element.\n\n### 2. ContextNode.tsx -- add drop target for team MIME type\n\nExtend the existing `handleDragOver` to also accept `application/contextflow-team`, but only for non-external contexts:\n\n```tsx\nconst handleDragOver = (e: React.DragEvent) =\u003e {\n  e.preventDefault()\n  e.stopPropagation()\n  const hasRepo = e.dataTransfer.types.includes('application/contextflow-repo')\n  const hasTeam = e.dataTransfer.types.includes('application/contextflow-team')\n  if (hasRepo || (hasTeam \u0026\u0026 context.ownership \\!== 'external')) {\n    setIsDragOver(true)\n  }\n}\n```\n\nExtend `handleDrop` to also read the team MIME type:\n\n```tsx\nconst handleDrop = (e: React.DragEvent) =\u003e {\n  e.preventDefault()\n  e.stopPropagation()\n  setIsDragOver(false)\n\n  const repoId = e.dataTransfer.getData('application/contextflow-repo')\n  if (repoId) {\n    assignRepoToContext(repoId, context.id)\n  }\n\n  const teamId = e.dataTransfer.getData('application/contextflow-team')\n  if (teamId) {\n    assignTeamToContext(context.id, teamId)\n  }\n}\n```\n\nNote: `assignTeamToContext` must be added to the store selectors at the top of the component, mirroring how `assignRepoToContext` is already imported.\n\n## Files affected\n\n- `src/components/TeamSidebar.tsx` -- add `draggable`, `onDragStart` to team card divs\n- `src/components/nodes/ContextNode.tsx` -- extend `handleDragOver` and `handleDrop` to handle `application/contextflow-team`; add `assignTeamToContext` store selector\n\n## Testing\n\n- Drag a team onto a non-external context: team is assigned\n- Drag a team onto an external context: no highlight, no assignment\n- Drag a team onto a context that already has a team: replaces the team\n- Existing repo drag-and-drop still works (regression check)\n\n## Not in scope\n\n- Drag from other surfaces (e.g., TeamInspector)\n- Multi-select drag (assigning one team to multiple contexts at once)\n- Cursor feedback (e.g., showing a \"not allowed\" cursor on external contexts)","status":"closed","priority":3,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-13T11:23:40.503869-07:00","created_by":"Paul Rayner","updated_at":"2026-02-15T13:19:18.490261-07:00","closed_at":"2026-02-15T13:19:18.490261-07:00","close_reason":"Closed"}
{"id":"contextflow-oof","title":"Clarify relationship direction","description":"Eric Evans: 'Direction was not the one I was expecting.' Upstream/downstream semantics need to be more obvious before committing. Consider arrows, labels, or visual flow indicators.","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-13T11:23:34.537594-07:00","created_by":"Paul Rayner","updated_at":"2026-02-13T15:16:11.55383-07:00","closed_at":"2026-02-13T15:16:11.55383-07:00","close_reason":"Closed"}
{"id":"contextflow-oqw","title":"Add clearActiveProject store action","description":"Add a clearActiveProject() action to the store that deactivates the current project and returns to the 'no project' state. This is the inverse of setActiveProject.\n\n## Implementation\n- Add clearActiveProject: () =\u003e void to EditorState in storeTypes.ts\n- Implement in store.ts: set activeProjectId to null, remove contextflow.activeProjectId from localStorage, clear all selections + undo/redo stacks, call destroyCollabMode()\n\n## Files\n- src/model/storeTypes.ts\n- src/model/store.ts\n\n## Tests\n- Verify clearActiveProject nulls activeProjectId, clears selections/undo, removes localStorage key\n\n## Part of contextflow-30w (project list landing page)","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-16T09:29:38.131668-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T10:06:47.026572-07:00","closed_at":"2026-02-16T10:06:47.026572-07:00","close_reason":"Implemented in commit 089feb7"}
{"id":"contextflow-ot2","title":"CRITICAL: Local Y.Doc not synced to IndexedDB - data loss on crash","description":"When a user opens a cloud-shared project, a network-connected Y.Doc is created but NEVER saved to IndexedDB. If the browser crashes or user loses network connection:\n- All changes made to the Y.Doc are lost\n- The local IndexedDB still contains the old project state\n- On reconnect/reload, users will lose all their work\n\nLocation: src/model/store.ts (lines 1035-1056)\n\nThe onProjectChange callback receives updated projects but autosaveIfNeeded() is never called. Need to add autosave to IndexedDB whenever Y.Doc changes via SyncManager callback.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-03T08:38:23.621774+08:00","updated_at":"2025-12-03T08:57:29.574752+08:00","closed_at":"2025-12-03T08:57:29.574752+08:00","dependencies":[{"issue_id":"contextflow-ot2","depends_on_id":"contextflow-33y","type":"blocks","created_at":"2025-12-03T08:38:29.713037+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-qbm","title":"collab-006: Two-browser sync integration test","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:00.866797+08:00","updated_at":"2025-12-02T21:28:49.846735+08:00","closed_at":"2025-12-02T21:28:49.846735+08:00","dependencies":[{"issue_id":"contextflow-qbm","depends_on_id":"contextflow-d0i","type":"blocks","created_at":"2025-12-01T18:29:59.784792+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-rd7","title":"Extract CanvasArea pure utility functions to separate modules","description":"CanvasArea.tsx (3659 lines) contains pure functions that should be extracted to testable modules. Follow the extract-and-prove pattern (copy exact, test, then replace usage).\n\nIMPORTANT: Some extraction targets already exist. Check existing files before creating new ones:\n- src/lib/edgeUtils.ts already has getEdgeState, getEdgeStrokeWidth, getIndicatorBoxPosition, getVerticalEdgeEndpoints\n- src/lib/canvasHelpers.ts already has getHoverConnectedContextIds, getEdgeLabelInfo\n- src/lib/distillationGrid.ts already has getGridPosition, needsRedistribution\n\nExtractions needed (add to existing files or create new ones as appropriate):\n\n1. **src/lib/edgeGeometry.ts** (NEW) - getBoxEdgePoint (line 108, 31 lines), getNodeIntersection (line 140, 18 lines), getEdgePosition (line 160, 19 lines), getEdgeParams (line 181, 28 lines). These calculate floating edge connection points between nodes. Zero React dependencies, pure math. Note: edgeUtils.ts handles visual state; edgeGeometry.ts handles spatial math. Keep them separate.\n\n2. **src/lib/positionUtils.ts** (NEW) - Extract from CanvasContent's useMemo:\n   - getContextCanvasPosition(context, viewMode, currentDate, keyframes) - view-mode-dependent position mapping (~30 lines, converts percentage positions to canvas pixel coordinates with temporal interpolation support)\n   - clampDragDelta(delta, selectedNodes, canvasBounds) - multi-drag boundary clamping (~23 lines in CanvasContent onNodesChange handler)\n\n3. **src/lib/nodeStyles.ts** (NEW) - Extract from ContextNode:\n   - getContextNodeBorderStyle(context, isDragOver, isHighlighted, isHovered) - shadow/border calculation (~30 lines of nested conditionals at ContextNode lines 328-356)\n   - parseRgbColor(color: string): [number, number, number] - color parsing from GroupNode (lines 1162-1173)\n\nDo NOT duplicate functions already in edgeUtils.ts or canvasHelpers.ts.\n\nAcceptance criteria:\n- Each extracted function is an exact copy (no logic changes)\n- Comprehensive tests for all new functions (target 100% coverage)\n- TypeScript compiles without errors\n- All existing tests still pass\n- Functions are not yet consumed by CanvasArea (that happens in the dependent beads)","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-14T21:47:44.199944-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T22:17:20.370555-07:00","closed_at":"2026-02-14T22:17:20.370555-07:00","close_reason":"Closed"}
{"id":"contextflow-rty","title":"entity-003: Migrate group mutations with tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:14.031143+08:00","updated_at":"2025-12-02T20:20:25.576698+08:00","closed_at":"2025-12-02T20:20:25.576698+08:00","dependencies":[{"issue_id":"contextflow-rty","depends_on_id":"contextflow-b14","type":"blocks","created_at":"2025-12-01T18:30:19.881846+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-ru2","title":"Add Home button to TopBar","description":"Add a Home icon button in the TopBar (between logo and project name dot separator) that navigates back to the project list by calling clearActiveProject().\n\n## Implementation\n- Import Home from lucide-react\n- Import clearActiveProject from store\n- Add Home icon button before the dot separator, wrapped in SimpleTooltip 'Back to projects'\n- onClick: call clearActiveProject()\n- Only visible when projectId is not null (safety guard, though TopBar is only rendered when project is active per slice 5)\n\n## Files\n- src/components/TopBar.tsx\n\n## Tests\n- Home button renders when project is active\n- Clicking Home calls clearActiveProject\n\n## Part of contextflow-30w (project list landing page)","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-16T09:30:02.752382-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T10:06:51.028214-07:00","closed_at":"2026-02-16T10:06:51.028214-07:00","close_reason":"Implemented in commit 089feb7","dependencies":[{"issue_id":"contextflow-ru2","depends_on_id":"contextflow-oqw","type":"blocks","created_at":"2026-02-16T09:30:40.321251-07:00","created_by":"Paul Rayner"},{"issue_id":"contextflow-ru2","depends_on_id":"contextflow-xs1","type":"blocks","created_at":"2026-02-16T09:30:40.401018-07:00","created_by":"Paul Rayner"}]}
{"id":"contextflow-t1z","title":"Built-in projects show 'Never' timestamp on project list","description":"Built-in projects lack createdAt/updatedAt fields, so getProjectMetadata returns undefined for lastModified, and formatRelativeTime renders 'Never'. Should either set timestamps on built-in projects or hide the timestamp for projects without one.","status":"closed","priority":2,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-16T10:06:23.174645-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T10:10:56.704217-07:00","closed_at":"2026-02-16T10:10:56.704217-07:00","close_reason":"Closed"}
{"id":"contextflow-t3z","title":"ui-006: Add URL routing for shared projects","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-01T17:54:07.448227+08:00","updated_at":"2025-12-02T21:53:25.518784+08:00","closed_at":"2025-12-02T21:53:25.518784+08:00","dependencies":[{"issue_id":"contextflow-t3z","depends_on_id":"contextflow-581","type":"blocks","created_at":"2025-12-01T18:31:10.415876+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-tg6","title":"ui-015: Production deployment","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:54:18.606331+08:00","updated_at":"2026-02-14T10:23:34.211912-07:00","closed_at":"2026-02-14T10:23:34.211912-07:00","close_reason":"Obsolete - production deploys happen ad-hoc via wrangler commands","dependencies":[{"issue_id":"contextflow-tg6","depends_on_id":"contextflow-3zy","type":"blocks","created_at":"2025-12-01T18:33:49.970467+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-uhf","title":"Fix orphaned data on context deletion (no cascade cleanup)","description":"When a context is deleted, 4 categories of related data are orphaned with dangling references:\n\n1. **Relationships** - fromContextId/toContextId point to deleted context (invisible broken edges)\n2. **Repos** - contextId points to deleted context (shows assigned to nonexistent context)\n3. **Groups** - contextIds array contains deleted context ID (wrong membership count, blob rendering)\n4. **NeedContextConnections** - contextId references deleted context (broken traceability chain)\n\nRoot cause: store.deleteContext (store.ts:438) delegates directly to getCollabMutations().deleteContext() which only removes the context from the Yjs contexts array. No cascade logic.\n\nNote: deleteContextAction in contextActions.ts DOES clean up temporal keyframes (lines 309-322), but this function is never called by the store's delete path. It's effectively dead code for the actual delete flow.\n\nFix: Add cascade cleanup in the deleteContext store handler (or in deleteContextMutation) to:\n- Remove relationships where fromContextId or toContextId matches\n- Clear contextId on repos mapped to the deleted context\n- Remove the context ID from all group.contextIds arrays\n- Remove needContextConnections where contextId matches\n- Remove the context from temporal keyframe activeContextIds and positions (currently only done in the unused deleteContextAction)\n\nDiscovered via Allium spec distillation - the spec surfaced this as an open question about what happens to repos when their mapped context is deleted.","status":"closed","priority":1,"issue_type":"bug","owner":"paul@virtualgenius.com","created_at":"2026-02-11T14:44:52.731872-07:00","created_by":"Paul Rayner","updated_at":"2026-02-13T11:22:54.446203-07:00","closed_at":"2026-02-13T11:22:54.446203-07:00","close_reason":"Cascade delete implemented in deleteContextMutation with 5 tests covering relationships, repos, groups, needContextConnections, and temporal keyframes. All 1324 tests passing."}
{"id":"contextflow-vlf","title":"Tooltip content assembly for context nodes (pure functions)","description":"## Goal\n\nCreate pure functions that assemble tooltip content lines for a context node based on view mode and node state. These are the data layer for the context hover tooltip; no UI or React code.\n\n## Functions to create\n\nCreate src/lib/contextTooltip.ts with:\n\n### getContextTooltipLines(params): string[]\n\nParameters:\n- context: BoundedContext\n- viewMode: ViewMode ('flow' | 'strategic' | 'distillation')\n- colorByMode: 'strategic' | 'ownership'\n- relationships: Relationship[] (all project relationships)\n- contexts: BoundedContext[] (all project contexts, for resolving connected names)\n\nReturns an array of strings, one per tooltip line.\n\n### Content rules by view mode\n\n**Value Stream mode (flow):**\n- Ownership line (based on colorByMode === 'ownership'): \"Our Team (green)\" / \"Internal (blue)\" / \"External (orange)\" -- or \"Click to set ownership\" if unset\n- Boundary integrity: \"Strong boundary\" / \"Moderate boundary\" / \"Weak boundary\" -- omit if unset\n- Issues: \"N issues\" if context.issues has entries\n- Connections: \"Connected to X, Y\" (names of contexts connected via relationships) -- omit if none\n- Guidance: \"Drag handles to connect to other contexts\"\n\n**Distillation mode:**\n- If unclassified: \"Drag to classify as Core, Supporting, or Generic\"\n- If classified: \"Core Domain - your primary competitive advantage\" (use short descriptions from STRATEGIC_CLASSIFICATIONS)\n\n**Strategic mode:**\n- Summary of all configured properties on one or two lines\n- \"Core Domain | Our Team | Strong boundary\"\n- \"N issues\" if any\n\n### TDD approach\n\nWrite tests first for each view mode covering:\n- Fully unconfigured context (all defaults)\n- Partially configured (some properties set)\n- Fully configured (everything set)\n- Edge cases: external context, zero relationships, multiple relationships\n\n## Files\n\n- src/lib/contextTooltip.ts (new)\n- src/lib/__tests__/contextTooltip.test.ts (new)\n\n## Acceptance criteria\n\n- [ ] Pure functions with no React/store dependencies\n- [ ] Full test coverage for all three view modes\n- [ ] Tests cover unconfigured, partial, and fully configured states\n- [ ] Uses existing types from model/types.ts and model/patternDefinitions.ts","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-13T11:23:28.548485-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T10:11:10.21797-07:00","closed_at":"2026-02-14T10:11:10.21797-07:00","close_reason":"Closed"}
{"id":"contextflow-w4z","title":"Extract store selection state to clearAllSelections helper","description":"store.ts (1331 lines) has two patterns of significant duplication that should be consolidated.\n\n**1. Selection state clearing (adopt existing createSelectionState)**\n\nA createSelectionState() helper already exists in src/model/validation.ts (line 42) and is already used by setSelectedContext, toggleContextSelection, and clearContextSelection. However, 7 other selection setters still manually list all selection fields:\n- setSelectedRelationship (line 546)\n- setSelectedStage (line 559)\n- setSelectedTeam (line 572)\n- setSelectedUser (line 655)\n- setSelectedUserNeed (line 717)\n- setSelectedUserNeedConnection (line 730)\n- setSelectedNeedContextConnection (line 743)\n\nThe work is to adopt createSelectionState in these 7 remaining setters. For example:\n  setSelectedRelationship: (relationshipId) =\u003e set({\n    ...createSelectionState(relationshipId, 'relationship'),\n  })\n\nAlso update the project lifecycle functions that clear selections manually:\n- setActiveProject (line 238-248)\n- createProject (line 337-346)\n- createFromTemplate (line 337-346 equivalent)\n- importProject (line ~1048)\n- loadSharedProject (line ~1126)\nThese should use createSelectionState(null, 'context') for the selection-clearing portion.\n\nNote: setSelectedTeam has a special null-handling branch (line 572-585). Verify createSelectionState handles the null case correctly (it does - returns all-null state).\n\nNote: addTeam (line 599-605) clears only some selection fields, not all. This may be intentional. Investigate before changing.\n\n**2. Collab initialization pattern**\n\ndestroyCollabMode() + connectToNetwork() + initializeCollabModeWithYDoc() appears in 5 functions (lines 254/277, 298/321, 352/375, 1052/1072, 1138/1162). Extract a shared helper:\n  async function switchProjectCollab(projectId, project, onProjectChange)\n\nAcceptance criteria:\n- All 7 remaining selection setters use createSelectionState\n- All 5 project lifecycle functions use createSelectionState for selection clearing\n- Collab init pattern extracted to shared helper\n- No behavioral changes (exact same state transitions)\n- All existing tests still pass","status":"closed","priority":3,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-14T21:48:08.099739-07:00","created_by":"Paul Rayner","updated_at":"2026-02-14T22:17:20.38932-07:00","closed_at":"2026-02-14T22:17:20.38932-07:00","close_reason":"Closed"}
{"id":"contextflow-wdy","title":"Remove welcome infrastructure","description":"Clean up all hasSeenWelcome / WelcomeModal artifacts now that the project list page replaces the welcome flow.\n\n## Implementation\n\n### Modify:\n- src/model/storeTypes.ts: Remove hasSeenWelcome, dismissWelcome, resetWelcome from EditorState\n- src/model/store.ts: Remove welcome state + actions + onboarding imports\n- src/components/settings/SettingsHelp.tsx: Remove 'Welcome Guide' button + onResetWelcome prop (keep Getting Started Guide and Keyboard Shortcuts)\n- src/components/TopBar.tsx: Remove resetWelcome selector, remove onResetWelcome prop to SettingsHelp\n- src/components/CanvasArea.tsx: Remove hasSeenWelcome selector (line 93). Pass true for welcomeModalDismissed in shouldShowGettingStartedGuide() call (line 1144)\n- src/model/actions/projectHelpers.ts: Keep shouldShowGettingStartedGuide, note welcomeModalDismissed is now always true (bead g85 will revisit)\n- src/model/actions/projectHelpers.test.ts: Update tests accordingly\n\n### Delete:\n- src/components/WelcomeModal.tsx\n- src/model/onboarding.ts\n- src/model/onboarding.test.ts\n\n## Tests\n- All existing tests pass after removal (no broken references)\n- Update projectHelpers tests for changed semantics\n\n## Part of contextflow-30w (project list landing page)","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-16T09:30:08.76939-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T10:06:51.026788-07:00","closed_at":"2026-02-16T10:06:51.026788-07:00","close_reason":"Implemented in commit 089feb7","dependencies":[{"issue_id":"contextflow-wdy","depends_on_id":"contextflow-xs1","type":"blocks","created_at":"2026-02-16T09:30:40.481072-07:00","created_by":"Paul Rayner"}]}
{"id":"contextflow-wjs","title":"Change initialActiveProjectId to null for first-time users","description":"Make the app start with no active project when there is no stored preference. First-time users see the project list page instead of auto-loading a sample project.\n\n## Implementation\n- In builtInProjects.ts, change initialActiveProjectId fallback from sampleProject.id to null\n- Update type to string | null\n- The collab auto-init guard at bottom of store.ts already checks if (initialState.activeProjectId \u0026\u0026 ...) so no change needed there\n- Returning users with a stored project ID still land on their last project\n\n## Files\n- src/model/builtInProjects.ts\n- src/model/builtInProjects.test.ts\n\n## Tests\n- Verify initialActiveProjectId returns null when localStorage has no stored project\n- Verify initialActiveProjectId returns stored ID when one exists and project is in initialProjects\n\n## Part of contextflow-30w (project list landing page)","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-16T09:29:41.681495-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T10:06:47.024929-07:00","closed_at":"2026-02-16T10:06:47.024929-07:00","close_reason":"Implemented in commit 089feb7"}
{"id":"contextflow-wnm","title":"Align team topology colors with official Team Topologies palette","description":"## Goal\n\nUse the official Team Topologies color palette consistently across all surfaces where topology type appears.\n\n## Official Colors (from github.com/TeamTopologies/Team-Shape-Templates)\n\n| Topology | Fill | Outline |\n|---|---|---|\n| Stream-aligned | `#FFEDB8` (warm yellow) | `#FFD966` |\n| Platform | `#B7CDF1` (light blue) | `#6D9EEB` |\n| Enabling | `#DFBDCF` (pink) | `#D09CB7` |\n| Complicated Subsystem | `#FFC08B` (orange) | `#E88814` |\n\n## Current State\n\nThree surfaces show topology type, each inconsistent:\n\n1. **TeamLabelsOverlay** (`src/components/overlays/TeamLabelsOverlay.tsx:31-37`) - has per-type colors, but wrong ones (green/purple/amber/red instead of yellow/blue/pink/orange)\n2. **TeamSidebar** (`src/components/TeamSidebar.tsx:104`) - uses a single `bg-indigo-100` for all types\n3. **TeamInspector** (`src/components/inspector/TeamInspector.tsx:48`) - uses a single `bg-indigo-100` for active toggle state\n\n## Implementation\n\nExtract a shared `TOPOLOGY_COLORS` constant in `src/lib/teamColors.ts` mapping each topology type to bg/border/text values derived from the official palette. Include an `unknown` fallback entry (neutral gray) for contexts with no topology assigned.\n\nSuggested mapping (light mode):\n- `stream-aligned`: bg `#FFEDB8`, border `#FFD966`, text `#92600a` (dark amber)\n- `platform`: bg `#B7CDF1`, border `#6D9EEB`, text `#1a4b8c` (dark blue)\n- `enabling`: bg `#DFBDCF`, border `#D09CB7`, text `#6b3a5c` (dark pink)\n- `complicated-subsystem`: bg `#FFC08B`, border `#E88814`, text `#7c3a00` (dark orange)\n- `unknown`: bg `#f8fafc`, border `#cbd5e1`, text `#475569` (neutral slate, same as current fallback)\n\nDark mode variants: darken the bg to ~20% opacity equivalent, lighten text for contrast. Example for stream-aligned: bg `#3d2e00`, border `#FFD966`, text `#FFE8A0`.\n\nApply this shared constant in all three surfaces:\n\n1. **`TeamLabelsOverlay.tsx`** - replace the inline `topologyColors` object (lines 31-37) with an import from `teamColors.ts`. The existing lookup pattern (`topologyColors[team.topologyType || 'unknown']`) stays the same.\n\n2. **`TeamSidebar.tsx`** - replace the `bg-indigo-100` badge (line 104) with per-type colors. Use Tailwind `style` prop with the color values, or map to Tailwind classes that approximate the palette.\n\n3. **`TeamInspector.tsx`** - replace the `bg-indigo-100` active toggle (line 48) with per-type colors based on the currently selected topology value.\n\n## Files affected\n\n- New: `src/lib/teamColors.ts` (shared constant + helper to get colors by type)\n- Modified: `src/components/overlays/TeamLabelsOverlay.tsx`\n- Modified: `src/components/TeamSidebar.tsx`\n- Modified: `src/components/inspector/TeamInspector.tsx`\n\n## Acceptance Criteria\n\n- All four topology types display their official color in all three surfaces\n- `unknown`/undefined topology falls back to neutral gray\n- Dark mode is readable (sufficient contrast between text and background)\n- No existing tests break\n- Write a unit test for the `teamColors.ts` helper verifying all five types return valid color objects","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-15T13:30:52.377258-07:00","created_by":"Paul Rayner","updated_at":"2026-02-15T13:38:35.244224-07:00","closed_at":"2026-02-15T13:38:35.244224-07:00","close_reason":"Closed"}
{"id":"contextflow-wpv","title":"infra-001: Add cloud sync dependencies (yjs, y-partyserver, wrangler)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:14.351878+08:00","updated_at":"2025-12-02T15:54:18.680816+08:00","closed_at":"2025-12-02T15:54:18.680816+08:00"}
{"id":"contextflow-wqo","title":"ui-012: Final regression testing","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:54:17.985299+08:00","updated_at":"2025-12-03T10:18:00.442249+08:00","closed_at":"2025-12-03T10:18:00.442249+08:00","dependencies":[{"issue_id":"contextflow-wqo","depends_on_id":"contextflow-bo5","type":"blocks","created_at":"2025-12-01T18:31:54.943546+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-wqo","depends_on_id":"contextflow-9ub","type":"blocks","created_at":"2025-12-01T18:31:55.126951+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-wqo","depends_on_id":"contextflow-dqw","type":"blocks","created_at":"2025-12-01T18:31:55.304734+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-wqo","depends_on_id":"contextflow-hl8","type":"blocks","created_at":"2025-12-01T18:31:55.476014+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-wqo","depends_on_id":"contextflow-806","type":"blocks","created_at":"2025-12-01T18:31:55.646088+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-wqo","depends_on_id":"contextflow-t3z","type":"blocks","created_at":"2025-12-01T18:31:55.812843+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-wqo","depends_on_id":"contextflow-2ko","type":"blocks","created_at":"2025-12-01T18:31:55.976554+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-wqo","depends_on_id":"contextflow-99t","type":"blocks","created_at":"2025-12-01T18:31:56.143703+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-wqo","depends_on_id":"contextflow-cls","type":"blocks","created_at":"2025-12-01T18:32:31.223358+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-wqo","depends_on_id":"contextflow-kel","type":"blocks","created_at":"2025-12-01T18:32:31.416453+08:00","created_by":"daemon","metadata":"{}"},{"issue_id":"contextflow-wqo","depends_on_id":"contextflow-yyp","type":"blocks","created_at":"2025-12-01T18:32:31.599031+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-x6h","title":"Keyboard shortcuts documentation overlay (Cmd/Ctrl+?)","description":"Add a keyboard shortcuts overlay that appears when pressing Cmd+Shift+/ (Mac) or Ctrl+Shift+/ (Windows/Linux). Shows all available shortcuts in a grouped modal.\n\n## Current shortcuts to document\n\nCanvas actions:\n- Escape: Deselect (clear selection)\n- Delete / Backspace: Delete selected relationship edge\n- Cmd/Ctrl+Z: Undo\n- Cmd/Ctrl+Shift+Z: Redo\n\nMouse/trackpad (non-keyboard, but useful to show):\n- Scroll/pinch: Zoom\n- Click+drag on canvas: Pan\n- Click+drag on node: Move node\n- Click+drag from node edge: Create relationship\n- Shift+click: Multi-select\n\nNew shortcut (this bead):\n- Cmd/Ctrl+Shift+/: Toggle this overlay\n\n## Implementation\n\n### Modal component\n- Create `KeyboardShortcutsModal.tsx` following the GettingStartedGuideModal pattern (fixed inset, z-50 overlay, dark mode support, Escape to close)\n- Group shortcuts into sections (Canvas, Editing, Navigation)\n- Display platform-aware modifier keys: Mac uses Unicode symbols (command, shift, option), Windows/Linux uses text (Ctrl, Shift, Alt). Detect via `navigator.userAgent` or `navigator.platform`\n\n### Keyboard trigger\n- Register a document-level keydown listener (NOT in CanvasArea.tsx, since the modal should be triggerable regardless of canvas focus)\n- Listen for `?` key with metaKey (Mac) or ctrlKey (Windows). Note: `?` requires Shift on standard keyboards, so the event fires as Shift+/ with meta/ctrl\n- Toggle behavior: pressing the shortcut while overlay is open should close it\n\n### Menu entry\n- Add \"Keyboard Shortcuts\" button in `SettingsHelp.tsx` (alongside \"Welcome Guide\" and \"Getting Started Guide\")\n- Show the shortcut hint (e.g., \"Cmd+?\" or \"Ctrl+?\") next to the menu item\n\n## Acceptance criteria\n- Modal opens via Cmd+Shift+/ (Mac) or Ctrl+Shift+/ (Windows/Linux)\n- Modal opens via Settings \u003e Help \u003e Keyboard Shortcuts menu item\n- Escape closes the modal\n- Pressing the trigger shortcut again closes the modal (toggle)\n- Modifier keys display correctly per platform\n- Dark mode supported\n- All current shortcuts are listed accurately","status":"closed","priority":3,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-15T17:53:32.160054-07:00","created_by":"Paul Rayner","updated_at":"2026-02-15T18:18:08.084935-07:00","closed_at":"2026-02-15T18:18:08.084935-07:00","close_reason":"Closed"}
{"id":"contextflow-xs1","title":"Wire ProjectListPage into App.tsx routing","description":"When activeProjectId is null and route is home, render ProjectListPage instead of the workspace. Remove WelcomeModal. Only render TopBar when a project is active.\n\n## Implementation\n- In App.tsx, add conditional: if route === 'home' and projectId === null, render ProjectListPage (full screen, no TopBar, no workspace grid)\n- If projectId is set, render TopBar + workspace as before\n- If route is shared-project, continue existing behavior unchanged\n- Remove showWelcomeModal logic, WelcomeModal render block, hasSeenWelcome/dismissWelcome selectors\n- Wrap TopBar in conditional: only render when projectId is not null\n\n## Files\n- src/App.tsx\n\n## Tests\n- When activeProjectId is null + route home: ProjectListPage renders, no TopBar\n- When activeProjectId is set: workspace renders with TopBar\n- WelcomeModal never renders\n\n## Part of contextflow-30w (project list landing page)","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-16T09:29:58.296261-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T10:06:51.025263-07:00","closed_at":"2026-02-16T10:06:51.025263-07:00","close_reason":"Implemented in commit 089feb7","dependencies":[{"issue_id":"contextflow-xs1","depends_on_id":"contextflow-oqw","type":"blocks","created_at":"2026-02-16T09:30:40.072985-07:00","created_by":"Paul Rayner"},{"issue_id":"contextflow-xs1","depends_on_id":"contextflow-wjs","type":"blocks","created_at":"2026-02-16T09:30:40.154013-07:00","created_by":"Paul Rayner"},{"issue_id":"contextflow-xs1","depends_on_id":"contextflow-b7e","type":"blocks","created_at":"2026-02-16T09:30:40.239442-07:00","created_by":"Paul Rayner"}]}
{"id":"contextflow-yob","title":"entity-005: Migrate metadata entity mutations with tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:52:14.399603+08:00","updated_at":"2025-12-02T21:10:14.768881+08:00","closed_at":"2025-12-02T21:10:14.768881+08:00","dependencies":[{"issue_id":"contextflow-yob","depends_on_id":"contextflow-8f7","type":"blocks","created_at":"2025-12-01T18:30:25.978308+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-ype","title":"infra-003: Create wrangler.toml configuration","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:24.989497+08:00","updated_at":"2025-12-02T16:10:48.316213+08:00","closed_at":"2025-12-02T16:10:48.316213+08:00","dependencies":[{"issue_id":"contextflow-ype","depends_on_id":"contextflow-i0a","type":"blocks","created_at":"2025-12-01T17:58:59.051422+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-ywr","title":"Reorder add buttons: Context, User, Need, Stage","description":"Reorder the add buttons in the top bar to: +Context, +User, +Need, +Stage.\n\n## Current order\n+Stage (Value Stream only), +User (not in Distillation), +Need (not in Distillation), +Context (always visible)\n\n## Proposed order\n+Context (always visible), +User (not in Distillation), +Need (not in Distillation), +Stage (Value Stream only)\n\nContext comes first because it's the primary entity in every view and the natural starting point for brownfield context mapping. The view-conditional visibility of Stage and User/Need buttons is unchanged; only the order within the group changes.\n\n## Key file\n- src/components/TopBar.tsx (lines ~255-294, the add buttons group)\n\n## Related\n- contextflow-81o: Swap add buttons and view toggle positions. Can be done in the same commit.","status":"closed","priority":2,"issue_type":"task","owner":"paul@virtualgenius.com","created_at":"2026-02-16T09:03:41.496866-07:00","created_by":"Paul Rayner","updated_at":"2026-02-16T09:11:25.024735-07:00","closed_at":"2026-02-16T09:11:25.024735-07:00","close_reason":"Closed"}
{"id":"contextflow-yyp","title":"ui-011: Add monitoring and logging","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:54:17.810245+08:00","updated_at":"2025-12-03T10:05:12.419545+08:00","closed_at":"2025-12-03T10:05:12.419545+08:00","dependencies":[{"issue_id":"contextflow-yyp","depends_on_id":"contextflow-581","type":"blocks","created_at":"2025-12-01T18:31:41.351456+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-z4f","title":"infra-005: Deploy to Cloudflare staging and verify WebSocket","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:25.186681+08:00","updated_at":"2025-12-02T16:16:43.385027+08:00","closed_at":"2025-12-02T16:16:43.385027+08:00","dependencies":[{"issue_id":"contextflow-z4f","depends_on_id":"contextflow-ype","type":"blocks","created_at":"2025-12-01T17:59:06.407708+08:00","created_by":"daemon","metadata":"{}"}]}
{"id":"contextflow-zaj","title":"infra-006: Capture baseline performance metrics (pre-Yjs)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T17:51:14.737268+08:00","updated_at":"2025-12-02T16:23:04.960086+08:00","closed_at":"2025-12-02T16:23:04.960086+08:00"}
{"id":"contextflow-ztd","title":"Inline explanations on controls","description":"Eric Evans feedback: replace separate legend/guide with contextual explanations directly on elements. His exact words: 'What is this thing? It is not a control. Put the explanation actually on the thing. Why not explain the color while I am at it. Make it unambiguously a control.'\n\nThis is about making the UI self-explaining rather than requiring a separate legend or guide modal. When a user sees a colored element, the color's meaning should be discoverable in-place (e.g., via hover tooltip or inline label), not by consulting a separate reference.\n\n## Current State (audit results)\n\nInfrastructure is solid: InfoTooltip system works correctly, respects showHelpTooltips setting, and is already used across many surfaces.\n\n### Already self-explaining (no work needed)\n- Distillation view zones: Core/Supporting/Generic all have InfoTooltip hover explanations\n- Evolution stage axis: Genesis/Custom-Built/Product/Commodity all have InfoTooltip hovers\n- Team topology badges in inspector: stream-aligned/platform/enabling/complicated-subsystem all have InfoTooltips\n- Connection handles: ConnectionGuidanceTooltip shows diagram for invalid connections\n- Relationship edges: pattern names visible on hover/select, InfoTooltip on hover shows full definition (contextflow-atz closed)\n\n### Gaps to fill\n\n1. **Context node color meaning not discoverable in-context**\n   - `contextTooltip.ts` generates text like \"Ownership: Our Team\" but it's plain text, not educational\n   - In flow/ownership mode (green/blue/orange), hovering shows ownership label but doesn't explain what green/blue/orange MEAN for decision-making\n   - In distillation mode, classification labels appear but lack the educational depth of InfoTooltips\n   - **Suggested fix**: Enhance `contextTooltip.ts` or the node hover to include brief educational context, OR add InfoTooltip-style content for ownership/classification concepts\n\n2. **Boundary strength has no visual distinction**\n   - Strong/Moderate/Weak boundary integrity is stored in context data and shown in text tooltips\n   - But context node borders are always the same style (no solid vs dashed vs dotted)\n   - `conceptDefinitions.ts` has full BOUNDARY_INTEGRITY definitions (lines 90-122)\n   - **Suggested fix**: Render node border style based on boundary integrity (solid=strong, dashed=moderate, dotted=weak), with InfoTooltip on the border or in the existing tooltip explaining the meaning\n\n3. **Team topology badges on canvas nodes lack explanation**\n   - Inspector panel badges have InfoTooltips, but the small team badges rendered on ContextNode in the canvas may not\n   - **Verify**: Check if TeamBadge on canvas nodes wraps in InfoTooltip or just shows abbreviated text\n   - **Suggested fix**: If missing, wrap canvas team badges in InfoTooltip using existing TEAM_TOPOLOGIES definitions\n\n## Key files\n- `src/lib/contextTooltip.ts` - generates context node hover text\n- `src/components/InfoTooltip.tsx` - educational tooltip component (needs ConceptDefinition)\n- `src/components/SimpleTooltip.tsx` - plain text tooltip (always shown, no settings guard)\n- `src/model/conceptDefinitions.ts` - all DDD/Wardley concept definitions\n- `src/components/nodes/ContextNode.tsx` - context node rendering\n- `src/components/RelationshipEdge.tsx` - relationship edge rendering\n- `src/components/overlays/DistillationRegions.tsx` - distillation zone overlays\n- `src/components/overlays/EvolutionBands.tsx` - evolution stage overlays\n- `src/components/inspector/TeamInspector.tsx` - team topology inspector\n\n## Approach\nIdentify remaining gaps where elements are not self-explaining, then add contextual hints (tooltips, inline labels, subtle annotations) directly on those elements. Use InfoTooltip with existing ConceptDefinition objects where educational content is needed; use SimpleTooltip for quick factual labels. Do not add new modals or separate reference panels.","status":"closed","priority":2,"issue_type":"feature","owner":"paul@virtualgenius.com","created_at":"2026-02-15T13:46:57.350438-07:00","created_by":"Paul Rayner","updated_at":"2026-02-15T14:00:21.486647-07:00","closed_at":"2026-02-15T14:00:21.486647-07:00","close_reason":"Enriched ownership/boundary tooltip labels with educational descriptions; added topology type + SimpleTooltip to TeamLabelsOverlay"}
